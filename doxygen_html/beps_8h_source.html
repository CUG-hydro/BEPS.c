<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Boreal Ecosystem Productivity Simulator Hourly v4.10: beps.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Boreal Ecosystem Productivity Simulator Hourly v4.10
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">beps.h</div></div>
</div><!--header-->
<div class="contents">
<a href="beps_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &quot;<a class="code" href="soil_8h.html">soil.h</a>&quot;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno"><a class="line" href="beps_8h.html#a7c8e007a5b28cfb6d606095153d7e764">   16</a></span><span class="preprocessor">#define NOERROR     0</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#define ERROR       1</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#define PI          3.1415926</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#define zero        0.0000000001</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment">//#define max(a,b)  (a&gt;b)?a:b         // used for UNIX</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">//#define min(a,b)  (a&lt;b)?a:b         // used for UNIX</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#define max(a,b)    ((a)&gt;(b))?(a):(b) </span><span class="comment">// LHE. the  original one can lead to disorder.</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#define min(a,b)    ((a)&lt;(b))?(a):(b) </span><span class="comment">// LHE</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#define l_sta       105    </span><span class="comment">// start line</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#define l_end       105    </span><span class="comment">// end line</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#define p_sta       101    </span><span class="comment">// start pix</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#define p_end       101    </span><span class="comment">// end pix</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#define RTIMES      24      </span><span class="comment">// 24</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#define step        3600    </span><span class="comment">// 3600 in sec</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#define kstep       360     </span><span class="comment">// 10 times per hour, 360 sec. per time</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#define kloop       10      </span><span class="comment">// 10 times per hour, 360 sec. per time</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#define layer       5</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#define depth_f     6</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#define CO2_air     380     </span><span class="comment">// atmospheric CO2 concentration</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#define rho_a       1.292   </span><span class="comment">// density of air at 0C</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno"><a class="line" href="structclimatedata.html">   42</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structclimatedata.html">climatedata</a></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>{</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    <span class="keywordtype">double</span> Srad;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    <span class="keywordtype">double</span> LR;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    <span class="keywordtype">double</span> temp;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <span class="keywordtype">double</span> rh;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    <span class="keywordtype">double</span> rain;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    <span class="keywordtype">double</span> wind;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    <span class="keywordtype">double</span> dr_o;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <span class="keywordtype">double</span> df_o;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    <span class="keywordtype">double</span> dr_u;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    <span class="keywordtype">double</span> df_u;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="comment">//  float st_c;</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>};</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="structresults.html">   57</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structresults.html">results</a></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>{</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    <span class="keywordtype">double</span> gpp_o_sunlit;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="keywordtype">double</span> gpp_u_sunlit;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="keywordtype">double</span> gpp_o_shaded;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="keywordtype">double</span> gpp_u_shaded;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="keywordtype">double</span> plant_resp;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    <span class="keywordtype">double</span> npp_o;</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="keywordtype">double</span> npp_u;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <span class="keywordtype">double</span> GPP;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <span class="keywordtype">double</span> NPP;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="keywordtype">double</span> NEP;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <span class="keywordtype">double</span> soil_resp;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <span class="keywordtype">double</span> Net_Rad;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    <span class="keywordtype">double</span> SH;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    <span class="keywordtype">double</span> LH;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    <span class="keywordtype">double</span> Trans;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    <span class="keywordtype">double</span> Evap;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>};</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno"><a class="line" href="structcpools.html">   77</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structcpools.html">cpools</a></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>{</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    <span class="keywordtype">double</span> Ccd[3];</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="keywordtype">double</span> Cssd[3];</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <span class="keywordtype">double</span> Csmd[3];</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="keywordtype">double</span> Cfsd[3];</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <span class="keywordtype">double</span> Cfmd[3];</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="keywordtype">double</span> Csm[3];</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="keywordtype">double</span> Cm[3];</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="keywordtype">double</span> Cs[3];</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <span class="keywordtype">double</span> Cp[3];</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>};</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="beps_8h.html#a3c72265f8029e562b04497c536cdbc45">   91</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a3c72265f8029e562b04497c536cdbc45">readconf</a>();</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="keywordtype">void</span> mid_prg();</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="keywordtype">void</span> readinput1();</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span><span class="keywordtype">void</span> readlai_d();</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span><span class="keywordtype">void</span> readlonlat();</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a6c02a3b86f67a8fae214acd97445ba1c">inter_prg</a>(<span class="keywordtype">int</span> jday,<span class="keywordtype">int</span> rstep,<span class="keywordtype">double</span> lai,<span class="keywordtype">double</span> clumping,<span class="keywordtype">double</span> parameter[],<span class="keyword">struct</span> <a class="code hl_struct" href="structclimatedata.html">climatedata</a>* meteo,</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>                 <span class="keywordtype">double</span> CosZs,<span class="keywordtype">double</span> var_o[],<span class="keywordtype">double</span> var_n[],<span class="keyword">struct</span> <a class="code hl_struct" href="struct_soil.html">Soil</a>* soilp,<span class="keyword">struct</span> <a class="code hl_struct" href="structresults.html">results</a>* mid_res);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#ac0fb52abdb8d4443b5f924713f66c6d1">s_coszs</a>(<span class="keywordtype">short</span> jday,<span class="keywordtype">short</span> j,<span class="keywordtype">float</span> lat,<span class="keywordtype">float</span> lon,<span class="keywordtype">double</span>* CosZs);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a6fb71e86f2d017c75626675ced14bb9c">aerodynamic_conductance</a>(<span class="keywordtype">double</span> canopy_height_o, <span class="keywordtype">double</span> canopy_height_u, <span class="keywordtype">double</span> zz, <span class="keywordtype">double</span> clumping,</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>                             <span class="keywordtype">double</span> temp_air, <span class="keywordtype">double</span> wind_sp, <span class="keywordtype">double</span> SH_o_p, <span class="keywordtype">double</span> lai_o, <span class="keywordtype">double</span> lai_u,</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>                             <span class="keywordtype">double</span> *rm, <span class="keywordtype">double</span> *ra_u, <span class="keywordtype">double</span> *ra_g, <span class="keywordtype">double</span> *G_o_a, <span class="keywordtype">double</span> *G_o_b, <span class="keywordtype">double</span> *G_u_a, <span class="keywordtype">double</span> *G_u_b);</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a5fc871429841fb77b43893474a5e0451">plantresp</a>(<span class="keywordtype">int</span> LC, <span class="keyword">struct</span> <a class="code hl_struct" href="structresults.html">results</a>* mid_res, <span class="keywordtype">double</span> lai_yr, <span class="keywordtype">double</span> lai,<span class="keywordtype">double</span> temp_air, <span class="keywordtype">double</span> temp_soil, <span class="keywordtype">double</span> CosZs);</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a5fbeeca1b348f3732bdb2620e0be8937">Vcmax_Jmax</a>(<span class="keywordtype">double</span> lai_o, <span class="keywordtype">double</span> clumping, <span class="keywordtype">double</span> Vcmax0,</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                <span class="keywordtype">double</span> slope_Vcmax_N, <span class="keywordtype">double</span> leaf_N, <span class="keywordtype">double</span> CosZs,</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>                <span class="keywordtype">double</span> *Vcmax_sunlit, <span class="keywordtype">double</span> *Vcmax_shaded, <span class="keywordtype">double</span> *Jmax_sunlit, <span class="keywordtype">double</span> *Jmax_shaded);</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#ad0512f7c2c7920479e2f293a8047363e">netRadiation</a>(<span class="keywordtype">double</span> shortRad_global, <span class="keywordtype">double</span> CosZs, <span class="keywordtype">double</span> temp_o, <span class="keywordtype">double</span> temp_u, <span class="keywordtype">double</span> temp_g,</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>                  <span class="keywordtype">double</span> lai_o, <span class="keywordtype">double</span> lai_u, <span class="keywordtype">double</span> lai_os, <span class="keywordtype">double</span> lai_us,</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                  <span class="keywordtype">double</span> lai_o_sunlit, <span class="keywordtype">double</span> lai_o_shaded, <span class="keywordtype">double</span> lai_u_sunlit, <span class="keywordtype">double</span> lai_u_shaded,</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                  <span class="keywordtype">double</span> clumping, <span class="keywordtype">double</span> temp_air, <span class="keywordtype">double</span> rh,</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                  <span class="keywordtype">double</span> albedo_snow_v, <span class="keywordtype">double</span> albedo_snow_n, <span class="keywordtype">double</span> percentArea_snow_o, <span class="keywordtype">double</span> percentArea_snow_u, <span class="keywordtype">double</span> percent_snow_g,</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                  <span class="keywordtype">double</span> albedo_v_o, <span class="keywordtype">double</span> albedo_n_o, <span class="keywordtype">double</span> albedo_v_u, <span class="keywordtype">double</span> albedo_n_u, <span class="keywordtype">double</span> albedo_v_g, <span class="keywordtype">double</span> albedo_n_g,</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>                  <span class="keywordtype">double</span>* netRad_o, <span class="keywordtype">double</span>* netRad_u, <span class="keywordtype">double</span>* netRad_g,</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                  <span class="keywordtype">double</span>* netRadLeaf_o_sunlit, <span class="keywordtype">double</span>* netRadLeaf_o_shaded, <span class="keywordtype">double</span>* netRadLeaf_u_sunlit, <span class="keywordtype">double</span>* netRadLeaf_u_shaded,</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>                  <span class="keywordtype">double</span>* netShortRadLeaf_o_sunlit, <span class="keywordtype">double</span>* netShortRadLeaf_o_shaded, <span class="keywordtype">double</span>* netShortRadLeaf_u_sunlit, <span class="keywordtype">double</span>* netShortRadLeaf_u_shaded);</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a7385d5d0240cacc36b46e53f792656ed">soilresp</a>(<span class="keywordtype">double</span>* Ccd, <span class="keywordtype">double</span>* Cssd, <span class="keywordtype">double</span>* Csmd, <span class="keywordtype">double</span>* Cfsd, <span class="keywordtype">double</span>* Cfmd,</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>              <span class="keywordtype">double</span>* Csm, <span class="keywordtype">double</span>* Cm, <span class="keywordtype">double</span>* Cs, <span class="keywordtype">double</span>* Cp, <span class="keywordtype">float</span> npp_yr, <span class="keywordtype">double</span>* coef,</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>              <span class="keywordtype">int</span> soiltype, <span class="keyword">struct</span> <a class="code hl_struct" href="struct_soil.html">Soil</a>* soilp,<span class="keyword">struct</span> <a class="code hl_struct" href="structresults.html">results</a>* mid_res);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span> </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span><span class="keywordtype">void</span> <a class="code hl_function" href="readparam_8c.html#ad34cd72fb7420cfa1aace172816d76b2">readparam</a>(<span class="keywordtype">short</span> lc, <span class="keywordtype">double</span> parameter1[]);</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span> </div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a1fc64f22e38f438d7af776304aad554a">lai2</a>(<span class="keywordtype">double</span> stem_o,<span class="keywordtype">double</span> stem_u,<span class="keywordtype">int</span> LC,<span class="keywordtype">double</span> CosZs,<span class="keywordtype">double</span> lai_o,<span class="keywordtype">double</span> clumping,<span class="keywordtype">double</span> lai_u,</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>          <span class="keywordtype">double</span>* lai_o_sunlit,<span class="keywordtype">double</span>* lai_o_shaded,<span class="keywordtype">double</span>* lai_u_sunlit,<span class="keywordtype">double</span>* lai_u_shaded,</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>          <span class="keywordtype">double</span>* PAI_o_sunlit,<span class="keywordtype">double</span>* PAI_o_shaded,<span class="keywordtype">double</span>* PAI_u_sunlit,<span class="keywordtype">double</span>* PAI_u_shaded);</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span><span class="keywordtype">void</span> <a class="code hl_function" href="readcoef_8c.html#ac99693f8638c0217c08f940706ee460a">readcoef</a>(<span class="keywordtype">short</span> lc, <span class="keywordtype">int</span> stxt, <span class="keywordtype">double</span> coef[]);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span> </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span><span class="keywordtype">void</span> readhydr_param();</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a63d88c03d1b3c21080b3873f6c88bc02">photosynthesis</a>(<span class="keywordtype">double</span> temp_leaf_p,<span class="keywordtype">double</span> rad_leaf, <span class="keywordtype">double</span> e_air, <span class="keywordtype">double</span> g_lb_w, <span class="keywordtype">double</span> vc_opt,</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                    <span class="keywordtype">double</span> f_soilwater,<span class="keywordtype">double</span> b_h2o, <span class="keywordtype">double</span> m_h2o, <span class="keywordtype">double</span> cii,<span class="keywordtype">double</span> temp_leaf_c,<span class="keywordtype">double</span> LH_leaf,</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                    <span class="keywordtype">double</span>* Gs_w, <span class="keywordtype">double</span>* aphoto, <span class="keywordtype">double</span>* ci);</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span><span class="keywordtype">void</span> soil_water_factor();</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#af808958823310e3a795c479ac996fdcf">Leaf_Temperatures</a>(<span class="keywordtype">double</span> Tair, <span class="keywordtype">double</span> slope, <span class="keywordtype">double</span> psychrometer, <span class="keywordtype">double</span> VPD_air, <span class="keywordtype">double</span> Cp_ca,</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                       <span class="keywordtype">double</span> Gw_o_sunlit, <span class="keywordtype">double</span> Gw_o_shaded, <span class="keywordtype">double</span> Gw_u_sunlit, <span class="keywordtype">double</span> Gw_u_shaded,</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                       <span class="keywordtype">double</span> Gww_o_sunlit, <span class="keywordtype">double</span> Gww_o_shaded, <span class="keywordtype">double</span> Gww_u_sunlit, <span class="keywordtype">double</span> Gww_u_shaded,</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                       <span class="keywordtype">double</span> Gh_o_sunlit, <span class="keywordtype">double</span> Gh_o_shaded, <span class="keywordtype">double</span> Gh_u_sunlit, <span class="keywordtype">double</span> Gh_u_shaded,</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                       <span class="keywordtype">double</span> Xcs_o, <span class="keywordtype">double</span> Xcl_o, <span class="keywordtype">double</span> Xcs_u, <span class="keywordtype">double</span> Xcl_u,</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>                       <span class="keywordtype">double</span> radiation_o_sun, <span class="keywordtype">double</span> radiation_o_shaded, <span class="keywordtype">double</span> radiation_u_sun, <span class="keywordtype">double</span> radiation_u_shaded,</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>                       <span class="keywordtype">double</span> *Tc_o_sunlit, <span class="keywordtype">double</span> *Tc_o_shaded, <span class="keywordtype">double</span> *Tc_u_sunlit, <span class="keywordtype">double</span> *Tc_u_shaded);</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span><span class="keywordtype">double</span> <a class="code hl_function" href="beps_8h.html#a0e60526f2328237683e1039745ed0392">Leaf_Temperature</a>(<span class="keywordtype">double</span> Tair, <span class="keywordtype">double</span> slope, <span class="keywordtype">double</span> psychrometer, <span class="keywordtype">double</span> VPD_air, <span class="keywordtype">double</span> Cp_ca,</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>                        <span class="keywordtype">double</span> Gw, <span class="keywordtype">double</span> Gww, <span class="keywordtype">double</span> Gh, <span class="keywordtype">double</span> Xcs, <span class="keywordtype">double</span> Xcl, <span class="keywordtype">double</span> radiation);</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span> </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#afe6bee973e8941b047b6da31abd2fd40">sensible_heat</a>(<span class="keywordtype">double</span> tempL_o_sunlit, <span class="keywordtype">double</span> tempL_o_shaded, <span class="keywordtype">double</span> tempL_u_sunlit, <span class="keywordtype">double</span> tempL_u_shaded,</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>                   <span class="keywordtype">double</span> temp_g, <span class="keywordtype">double</span> temp_air, <span class="keywordtype">double</span> rh_air,</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>                   <span class="keywordtype">double</span> Gheat_o_sunlit, <span class="keywordtype">double</span> Gheat_o_shaded, <span class="keywordtype">double</span> Gheat_u_sunlit, <span class="keywordtype">double</span> Gheat_u_shaded, <span class="keywordtype">double</span> Gheat_g,</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>                   <span class="keywordtype">double</span> lai_o_sunlit, <span class="keywordtype">double</span> lai_o_shaded, <span class="keywordtype">double</span> lai_u_sunlit, <span class="keywordtype">double</span> lai_u_shaded,</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>                   <span class="keywordtype">double</span>* SH_o, <span class="keywordtype">double</span>* SH_u, <span class="keywordtype">double</span>* SH_g);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a8fb46fbf5ca3c002533cbc36bf8dbe3a">transpiration</a>(<span class="keywordtype">double</span> tempL_o_sunlit, <span class="keywordtype">double</span> tempL_o_shaded, <span class="keywordtype">double</span> tempL_u_sunlit, <span class="keywordtype">double</span> tempL_u_shaded,</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                   <span class="keywordtype">double</span> temp_air, <span class="keywordtype">double</span> rh_air,</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>                   <span class="keywordtype">double</span> Gtrans_o_sunlit, <span class="keywordtype">double</span> Gtrans_o_shaded, <span class="keywordtype">double</span> Gtrans_u_sunlit, <span class="keywordtype">double</span> Gtrans_u_shaded,</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>                   <span class="keywordtype">double</span> lai_o_sunlit, <span class="keywordtype">double</span> lai_o_shaded, <span class="keywordtype">double</span> lai_u_sunlit, <span class="keywordtype">double</span> lai_u_shaded,</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>                   <span class="keywordtype">double</span>* trans_o, <span class="keywordtype">double</span>* trans_u);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a18e461617f7d17b9327a7f637244a496">evaporation_canopy</a>(<span class="keywordtype">double</span> tempL_o_sunlit, <span class="keywordtype">double</span> tempL_o_shaded, <span class="keywordtype">double</span> tempL_u_sunlit, <span class="keywordtype">double</span> tempL_u_shaded,</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>                        <span class="keywordtype">double</span> temp_air, <span class="keywordtype">double</span> rh_air,</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>                        <span class="keywordtype">double</span> Gwater_o_sunlit, <span class="keywordtype">double</span> Gwater_o_shaded, <span class="keywordtype">double</span> Gwater_u_sunlit, <span class="keywordtype">double</span> Gwater_u_shaded,</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>                        <span class="keywordtype">double</span> lai_o_sunlit, <span class="keywordtype">double</span> lai_o_shaded, <span class="keywordtype">double</span> lai_u_sunlit, <span class="keywordtype">double</span> lai_u_shaded,</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>                        <span class="keywordtype">double</span> percent_water_o, <span class="keywordtype">double</span> percent_water_u, <span class="keywordtype">double</span> percent_snow_o, <span class="keywordtype">double</span> percent_snow_u,</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>                        <span class="keywordtype">double</span>* evapo_water_o, <span class="keywordtype">double</span>* evapo_water_u, <span class="keywordtype">double</span>* evapo_snow_o, <span class="keywordtype">double</span>* evapo_snow_u);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a8d0775f289240bf05f662483b6ad6b32">evaporation_soil</a>(<span class="keywordtype">double</span> temp_air, <span class="keywordtype">double</span> temp_g, <span class="keywordtype">double</span> rh_air, <span class="keywordtype">double</span> netRad_g, <span class="keywordtype">double</span> Gheat_g,</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>                      <span class="keywordtype">double</span>* percent_snow_g,<span class="keywordtype">double</span>* depth_water, <span class="keywordtype">double</span>* depth_snow, <span class="keywordtype">double</span>* mass_water_g, <span class="keywordtype">double</span>* mass_snow_g,</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>                      <span class="keywordtype">double</span> density_snow, <span class="keywordtype">double</span> swc_g, <span class="keywordtype">double</span> porosity_g,</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>                      <span class="keywordtype">double</span>* evapo_soil, <span class="keywordtype">double</span>* evapo_water_g, <span class="keywordtype">double</span>* evapo_snow_g);</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span> </div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a62a1eec9667a887e1a9bfd32a56ea67c">rainfall_stage1</a>(<span class="keywordtype">double</span> temp_air, <span class="keywordtype">double</span> precipitation, <span class="keywordtype">double</span> mass_water_o_last, <span class="keywordtype">double</span> mass_water_u_last,</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>                     <span class="keywordtype">double</span>  lai_o, <span class="keywordtype">double</span> lai_u, <span class="keywordtype">double</span> clumping,</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                     <span class="keywordtype">double</span>* mass_water_o, <span class="keywordtype">double</span>* mass_water_u,</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>                     <span class="keywordtype">double</span>* percent_water_o, <span class="keywordtype">double</span>* percent_water_u, <span class="keywordtype">double</span>* precipitation_g);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a5b417e26208501b9cbcc8576b136e598">rainfall_stage2</a>(<span class="keywordtype">double</span> evapo_water_o, <span class="keywordtype">double</span> evapo_water_u,</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>                     <span class="keywordtype">double</span>* mass_water_o, <span class="keywordtype">double</span>* mass_water_u);</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span><span class="keywordtype">void</span> rainfall_stage3();</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a74d0e9f235b59eaf094a63d6e697c8e3">meteo_pack</a>(<span class="keywordtype">double</span> temp, <span class="keywordtype">double</span> rh, <span class="keywordtype">double</span>* meteo_pack_output);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a543a621a86a39d5edf09723ff7252571">surface_temperature</a>(<span class="keywordtype">double</span> temp_air,<span class="keywordtype">double</span> rh_air, <span class="keywordtype">double</span> depth_snow, <span class="keywordtype">double</span> depth_water,</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>                         <span class="keywordtype">double</span> capacity_heat_soil1, <span class="keywordtype">double</span> capacity_heat_soil0, <span class="keywordtype">double</span> Gheat_g,</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>                         <span class="keywordtype">double</span> depth_soil1, <span class="keywordtype">double</span> density_snow,<span class="keywordtype">double</span> tempL_u, <span class="keywordtype">double</span> netRad_g,</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>                         <span class="keywordtype">double</span> evapo_soil, <span class="keywordtype">double</span> evapo_water_g, <span class="keywordtype">double</span> evapo_snow_g, <span class="keywordtype">double</span> lambda_soil1,</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>                         <span class="keywordtype">double</span> percent_snow_g, <span class="keywordtype">double</span> heat_flux_soil1, <span class="keywordtype">double</span> temp_ground_last,</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>                         <span class="keywordtype">double</span> temp_soil1_last, <span class="keywordtype">double</span> temp_any0_last, <span class="keywordtype">double</span> temp_snow_last,</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>                         <span class="keywordtype">double</span> temp_soil0_last, <span class="keywordtype">double</span> temp_snow1_last, <span class="keywordtype">double</span> temp_snow2_last,</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>                         <span class="keywordtype">double</span>* temp_ground, <span class="keywordtype">double</span>* temp_any0, <span class="keywordtype">double</span>* temp_snow,</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>                         <span class="keywordtype">double</span>* temp_soil0, <span class="keywordtype">double</span>* temp_snow1, <span class="keywordtype">double</span>* temp_snow2, <span class="keywordtype">double</span>* heat_flux);</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a7970c5267f32a503569127e3ba702edd">snowpack_stage1</a>(<span class="keywordtype">double</span> temp_air, <span class="keywordtype">double</span> precipitation,<span class="keywordtype">double</span> mass_snow_o_last, <span class="keywordtype">double</span> mass_snow_u_last,</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>                     <span class="keywordtype">double</span> mass_snow_g_last, <span class="keywordtype">double</span>* mass_snow_o, <span class="keywordtype">double</span>* mass_snow_u, <span class="keywordtype">double</span>* mass_snow_g,</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>                     <span class="keywordtype">double</span> lai_o, <span class="keywordtype">double</span> lai_u, <span class="keywordtype">double</span> clumping, <span class="keywordtype">double</span>* area_snow_o, <span class="keywordtype">double</span>* area_snow_u,</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>                     <span class="keywordtype">double</span>* percent_snow_o, <span class="keywordtype">double</span>* percent_snow_u, <span class="keywordtype">double</span>* percent_snow_g,</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>                     <span class="keywordtype">double</span>* density_snow, <span class="keywordtype">double</span>* depth_snow, <span class="keywordtype">double</span>* albedo_v_snow, <span class="keywordtype">double</span>* albedo_n_snow);</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span> </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a6d6185a683cfa4bcc98870f6108666bc">snowpack_stage2</a>(<span class="keywordtype">double</span> evapo_snow_o, <span class="keywordtype">double</span> evapo_snow_u,</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>                     <span class="keywordtype">double</span>* mass_snow_o, <span class="keywordtype">double</span>* mass_snow_u);</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span><span class="keywordtype">void</span> <a class="code hl_function" href="beps_8h.html#a21f2bf33a62ab7d7acba0decde33b961">snowpack_stage3</a>(<span class="keywordtype">double</span> temp_air, <span class="keywordtype">double</span> temp_snow, <span class="keywordtype">double</span> temp_snow_last, <span class="keywordtype">double</span> density_snow,</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>                     <span class="keywordtype">double</span>* depth_snow, <span class="keywordtype">double</span>* depth_water, <span class="keywordtype">double</span>* mass_snow_g);</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno"><a class="line" href="beps_8h.html#a8a3ae8ec94331c6db9ea5475817634ab">  208</a></span><span class="keywordtype">short</span> <a class="code hl_variable" href="beps_8h.html#a8a3ae8ec94331c6db9ea5475817634ab">lc_no</a>;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span><span class="keywordtype">int</span> yr,bgn_day,end_day;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span><span class="keywordtype">int</span> npixels,nlines;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span><span class="keywordtype">char</span> lc_fn[255];       <span class="comment">/* Land cover file */</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span><span class="keywordtype">char</span> lai_fn[255];      <span class="comment">/* Leaf area index file  */</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span><span class="keywordtype">char</span> lai_fp[255];      <span class="comment">/* Leaf area index file prefix */</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span><span class="keywordtype">char</span> stxt_fn[255];     <span class="comment">/* soil texture file */</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span><span class="keywordtype">char</span> ci_fn[255];       <span class="comment">/* clumping index file */</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span><span class="keywordtype">char</span> st_fn[255];       <span class="comment">/* initial values of soil temp */</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span><span class="keywordtype">char</span> sw_fn[255];       <span class="comment">/* initial values of soil water */</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span><span class="keywordtype">char</span> sdp_fn[255];      <span class="comment">/* initial values of snow depth*/</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span><span class="keywordtype">char</span> r_fn[255];        <span class="comment">/* meteor. data files */</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span><span class="keywordtype">char</span> t_fn[255];</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span><span class="keywordtype">char</span> h_fn[255];</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span><span class="keywordtype">char</span> p_fn[255];</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span><span class="keywordtype">char</span> wd_fn[255];</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span><span class="keywordtype">char</span> lon_fn[255];</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span><span class="keywordtype">char</span> lat_fn[255];</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span><span class="keywordtype">char</span> fp4outp1[255];     <span class="comment">/* output file1 prefix */</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span><span class="keywordtype">char</span> fp4outp2[255];     <span class="comment">/* output file2 prefix */</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span><span class="keywordtype">char</span> fp4outp3[255];     <span class="comment">/* output file3 prefix */</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="ttc" id="abeps_8h_html_a0e60526f2328237683e1039745ed0392"><div class="ttname"><a href="beps_8h.html#a0e60526f2328237683e1039745ed0392">Leaf_Temperature</a></div><div class="ttdeci">double Leaf_Temperature(double Tair, double slope, double psychrometer, double VPD_air, double Cp_ca, double Gw, double Gww, double Gh, double Xcs, double Xcl, double radiation)</div><div class="ttdoc">Subroutine to calculate leaf temperature.</div><div class="ttdef"><b>Definition:</b> calc_temp_leaf.c:87</div></div>
<div class="ttc" id="abeps_8h_html_a18e461617f7d17b9327a7f637244a496"><div class="ttname"><a href="beps_8h.html#a18e461617f7d17b9327a7f637244a496">evaporation_canopy</a></div><div class="ttdeci">void evaporation_canopy(double tempL_o_sunlit, double tempL_o_shaded, double tempL_u_sunlit, double tempL_u_shaded, double temp_air, double rh_air, double Gwater_o_sunlit, double Gwater_o_shaded, double Gwater_u_sunlit, double Gwater_u_shaded, double lai_o_sunlit, double lai_o_shaded, double lai_u_sunlit, double lai_u_shaded, double percent_water_o, double percent_water_u, double percent_snow_o, double percent_snow_u, double *evapo_water_o, double *evapo_water_u, double *evapo_snow_o, double *evapo_snow_u)</div><div class="ttdoc">Function to calculate evaporation and sublimation from canopy.</div><div class="ttdef"><b>Definition:</b> evaporation_canopy.c:40</div></div>
<div class="ttc" id="abeps_8h_html_a1fc64f22e38f438d7af776304aad554a"><div class="ttname"><a href="beps_8h.html#a1fc64f22e38f438d7af776304aad554a">lai2</a></div><div class="ttdeci">void lai2(double stem_o, double stem_u, int LC, double CosZs, double lai_o, double clumping, double lai_u, double *lai_o_sunlit, double *lai_o_shaded, double *lai_u_sunlit, double *lai_u_shaded, double *PAI_o_sunlit, double *PAI_o_shaded, double *PAI_u_sunlit, double *PAI_u_shaded)</div><div class="ttdoc">Function to recalculate sunlit and shaded leaf area index.</div><div class="ttdef"><b>Definition:</b> lai_calc.c:25</div></div>
<div class="ttc" id="abeps_8h_html_a21f2bf33a62ab7d7acba0decde33b961"><div class="ttname"><a href="beps_8h.html#a21f2bf33a62ab7d7acba0decde33b961">snowpack_stage3</a></div><div class="ttdeci">void snowpack_stage3(double temp_air, double temp_snow, double temp_snow_last, double density_snow, double *depth_snow, double *depth_water, double *mass_snow_g)</div><div class="ttdoc">Function of snowpack stage3. This module simulates the process of snow melting and water frozen in th...</div><div class="ttdef"><b>Definition:</b> snowpack.c:218</div></div>
<div class="ttc" id="abeps_8h_html_a3c72265f8029e562b04497c536cdbc45"><div class="ttname"><a href="beps_8h.html#a3c72265f8029e562b04497c536cdbc45">readconf</a></div><div class="ttdeci">void readconf()</div><div class="ttdoc">Declare functions.</div></div>
<div class="ttc" id="abeps_8h_html_a543a621a86a39d5edf09723ff7252571"><div class="ttname"><a href="beps_8h.html#a543a621a86a39d5edf09723ff7252571">surface_temperature</a></div><div class="ttdeci">void surface_temperature(double temp_air, double rh_air, double depth_snow, double depth_water, double capacity_heat_soil1, double capacity_heat_soil0, double Gheat_g, double depth_soil1, double density_snow, double tempL_u, double netRad_g, double evapo_soil, double evapo_water_g, double evapo_snow_g, double lambda_soil1, double percent_snow_g, double heat_flux_soil1, double temp_ground_last, double temp_soil1_last, double temp_any0_last, double temp_snow_last, double temp_soil0_last, double temp_snow1_last, double temp_snow2_last, double *temp_ground, double *temp_any0, double *temp_snow, double *temp_soil0, double *temp_snow1, double *temp_snow2, double *heat_flux)</div><div class="ttdoc">Function to simulate surface temperature, and heat flux from surface to soil layers.</div><div class="ttdef"><b>Definition:</b> surface_temp.c:49</div></div>
<div class="ttc" id="abeps_8h_html_a5b417e26208501b9cbcc8576b136e598"><div class="ttname"><a href="beps_8h.html#a5b417e26208501b9cbcc8576b136e598">rainfall_stage2</a></div><div class="ttdeci">void rainfall_stage2(double evapo_water_o, double evapo_water_u, double *mass_water_o, double *mass_water_u)</div><div class="ttdoc">Function of rainfall stage2.</div><div class="ttdef"><b>Definition:</b> rainfall.c:107</div></div>
<div class="ttc" id="abeps_8h_html_a5fbeeca1b348f3732bdb2620e0be8937"><div class="ttname"><a href="beps_8h.html#a5fbeeca1b348f3732bdb2620e0be8937">Vcmax_Jmax</a></div><div class="ttdeci">void Vcmax_Jmax(double lai_o, double clumping, double Vcmax0, double slope_Vcmax_N, double leaf_N, double CosZs, double *Vcmax_sunlit, double *Vcmax_shaded, double *Jmax_sunlit, double *Jmax_shaded)</div><div class="ttdoc">Function to calculate the Vcmax and Jmax for sunlit and shaded leaf.</div><div class="ttdef"><b>Definition:</b> vcmax_jmax_mod.c:34</div></div>
<div class="ttc" id="abeps_8h_html_a5fc871429841fb77b43893474a5e0451"><div class="ttname"><a href="beps_8h.html#a5fc871429841fb77b43893474a5e0451">plantresp</a></div><div class="ttdeci">void plantresp(int LC, struct results *mid_res, double lai_yr, double lai, double temp_air, double temp_soil, double CosZs)</div><div class="ttdoc">Function to calculate plant respiration.</div><div class="ttdef"><b>Definition:</b> plant_respir.c:20</div></div>
<div class="ttc" id="abeps_8h_html_a62a1eec9667a887e1a9bfd32a56ea67c"><div class="ttname"><a href="beps_8h.html#a62a1eec9667a887e1a9bfd32a56ea67c">rainfall_stage1</a></div><div class="ttdeci">void rainfall_stage1(double temp_air, double precipitation, double mass_water_o_last, double mass_water_u_last, double lai_o, double lai_u, double clumping, double *mass_water_o, double *mass_water_u, double *percent_water_o, double *percent_water_u, double *precipitation_g)</div><div class="ttdoc">Function of rainfall stage1.</div><div class="ttdef"><b>Definition:</b> rainfall.c:40</div></div>
<div class="ttc" id="abeps_8h_html_a63d88c03d1b3c21080b3873f6c88bc02"><div class="ttname"><a href="beps_8h.html#a63d88c03d1b3c21080b3873f6c88bc02">photosynthesis</a></div><div class="ttdeci">void photosynthesis(double temp_leaf_p, double rad_leaf, double e_air, double g_lb_w, double vc_opt, double f_soilwater, double b_h2o, double m_h2o, double cii, double temp_leaf_c, double LH_leaf, double *Gs_w, double *aphoto, double *ci)</div><div class="ttdoc">Function to calculate leaf photosynthesis by solving a cubic equation.</div><div class="ttdef"><b>Definition:</b> photosyn_gs.c:123</div></div>
<div class="ttc" id="abeps_8h_html_a6c02a3b86f67a8fae214acd97445ba1c"><div class="ttname"><a href="beps_8h.html#a6c02a3b86f67a8fae214acd97445ba1c">inter_prg</a></div><div class="ttdeci">void inter_prg(int jday, int rstep, double lai, double clumping, double parameter[], struct climatedata *meteo, double CosZs, double var_o[], double var_n[], struct Soil *soilp, struct results *mid_res)</div><div class="ttdoc">the inter-module function between main program and modules</div><div class="ttdef"><b>Definition:</b> inter_prg.c:21</div></div>
<div class="ttc" id="abeps_8h_html_a6d6185a683cfa4bcc98870f6108666bc"><div class="ttname"><a href="beps_8h.html#a6d6185a683cfa4bcc98870f6108666bc">snowpack_stage2</a></div><div class="ttdeci">void snowpack_stage2(double evapo_snow_o, double evapo_snow_u, double *mass_snow_o, double *mass_snow_u)</div><div class="ttdoc">Function of snowpack stage2. This module will calculate the snow remained on canopy surface after eva...</div><div class="ttdef"><b>Definition:</b> snowpack.c:190</div></div>
<div class="ttc" id="abeps_8h_html_a6fb71e86f2d017c75626675ced14bb9c"><div class="ttname"><a href="beps_8h.html#a6fb71e86f2d017c75626675ced14bb9c">aerodynamic_conductance</a></div><div class="ttdeci">void aerodynamic_conductance(double canopy_height_o, double canopy_height_u, double zz, double clumping, double temp_air, double wind_sp, double SH_o_p, double lai_o, double lai_u, double *rm, double *ra_u, double *ra_g, double *G_o_a, double *G_o_b, double *G_u_a, double *G_u_b)</div><div class="ttdoc">Function to calculate aerodynamic resistance and conductance.</div><div class="ttdef"><b>Definition:</b> aerodynamic_conductance.c:29</div></div>
<div class="ttc" id="abeps_8h_html_a7385d5d0240cacc36b46e53f792656ed"><div class="ttname"><a href="beps_8h.html#a7385d5d0240cacc36b46e53f792656ed">soilresp</a></div><div class="ttdeci">void soilresp(double *Ccd, double *Cssd, double *Csmd, double *Cfsd, double *Cfmd, double *Csm, double *Cm, double *Cs, double *Cp, float npp_yr, double *coef, int soiltype, struct Soil *soilp, struct results *mid_res)</div><div class="ttdoc">Function to calculate soil respiration.</div><div class="ttdef"><b>Definition:</b> soilresp.c:25</div></div>
<div class="ttc" id="abeps_8h_html_a74d0e9f235b59eaf094a63d6e697c8e3"><div class="ttname"><a href="beps_8h.html#a74d0e9f235b59eaf094a63d6e697c8e3">meteo_pack</a></div><div class="ttdeci">void meteo_pack(double temp, double rh, double *meteo_pack_output)</div><div class="ttdoc">Function to calculate meteorological variables based on input.</div><div class="ttdef"><b>Definition:</b> meteo_pack.c:25</div></div>
<div class="ttc" id="abeps_8h_html_a7970c5267f32a503569127e3ba702edd"><div class="ttname"><a href="beps_8h.html#a7970c5267f32a503569127e3ba702edd">snowpack_stage1</a></div><div class="ttdeci">void snowpack_stage1(double temp_air, double precipitation, double mass_snow_o_last, double mass_snow_u_last, double mass_snow_g_last, double *mass_snow_o, double *mass_snow_u, double *mass_snow_g, double lai_o, double lai_u, double clumping, double *area_snow_o, double *area_snow_u, double *percent_snow_o, double *percent_snow_u, double *percent_snow_g, double *density_snow, double *depth_snow, double *albedo_v_snow, double *albedo_n_snow)</div><div class="ttdoc">Function of snowpack stage1.</div><div class="ttdef"><b>Definition:</b> snowpack.c:43</div></div>
<div class="ttc" id="abeps_8h_html_a8a3ae8ec94331c6db9ea5475817634ab"><div class="ttname"><a href="beps_8h.html#a8a3ae8ec94331c6db9ea5475817634ab">lc_no</a></div><div class="ttdeci">short lc_no</div><div class="ttdoc">Declare global variables.</div><div class="ttdef"><b>Definition:</b> beps.h:208</div></div>
<div class="ttc" id="abeps_8h_html_a8d0775f289240bf05f662483b6ad6b32"><div class="ttname"><a href="beps_8h.html#a8d0775f289240bf05f662483b6ad6b32">evaporation_soil</a></div><div class="ttdeci">void evaporation_soil(double temp_air, double temp_g, double rh_air, double netRad_g, double Gheat_g, double *percent_snow_g, double *depth_water, double *depth_snow, double *mass_water_g, double *mass_snow_g, double density_snow, double swc_g, double porosity_g, double *evapo_soil, double *evapo_water_g, double *evapo_snow_g)</div><div class="ttdoc">Function to calculate evaporation from ground surface/top soil, and the evaporation of snow and pond ...</div><div class="ttdef"><b>Definition:</b> evaporation_soil.c:37</div></div>
<div class="ttc" id="abeps_8h_html_a8fb46fbf5ca3c002533cbc36bf8dbe3a"><div class="ttname"><a href="beps_8h.html#a8fb46fbf5ca3c002533cbc36bf8dbe3a">transpiration</a></div><div class="ttdeci">void transpiration(double tempL_o_sunlit, double tempL_o_shaded, double tempL_u_sunlit, double tempL_u_shaded, double temp_air, double rh_air, double Gtrans_o_sunlit, double Gtrans_o_shaded, double Gtrans_u_sunlit, double Gtrans_u_shaded, double lai_o_sunlit, double lai_o_shaded, double lai_u_sunlit, double lai_u_shaded, double *trans_o, double *trans_u)</div><div class="ttdoc">Function to calculate transpiration.</div><div class="ttdef"><b>Definition:</b> transpiration.c:37</div></div>
<div class="ttc" id="abeps_8h_html_ac0fb52abdb8d4443b5f924713f66c6d1"><div class="ttname"><a href="beps_8h.html#ac0fb52abdb8d4443b5f924713f66c6d1">s_coszs</a></div><div class="ttdeci">void s_coszs(short jday, short j, float lat, float lon, double *CosZs)</div><div class="ttdoc">Function to calculate cosine solar zenith angle.</div><div class="ttdef"><b>Definition:</b> s_coszs.c:16</div></div>
<div class="ttc" id="abeps_8h_html_ad0512f7c2c7920479e2f293a8047363e"><div class="ttname"><a href="beps_8h.html#ad0512f7c2c7920479e2f293a8047363e">netRadiation</a></div><div class="ttdeci">void netRadiation(double shortRad_global, double CosZs, double temp_o, double temp_u, double temp_g, double lai_o, double lai_u, double lai_os, double lai_us, double lai_o_sunlit, double lai_o_shaded, double lai_u_sunlit, double lai_u_shaded, double clumping, double temp_air, double rh, double albedo_snow_v, double albedo_snow_n, double percentArea_snow_o, double percentArea_snow_u, double percent_snow_g, double albedo_v_o, double albedo_n_o, double albedo_v_u, double albedo_n_u, double albedo_v_g, double albedo_n_g, double *netRad_o, double *netRad_u, double *netRad_g, double *netRadLeaf_o_sunlit, double *netRadLeaf_o_shaded, double *netRadLeaf_u_sunlit, double *netRadLeaf_u_shaded, double *netShortRadLeaf_o_sunlit, double *netShortRadLeaf_o_shaded, double *netShortRadLeaf_u_sunlit, double *netShortRadLeaf_u_shaded)</div><div class="ttdoc">Function to calculate net radiation at canopy level and leaf level.</div><div class="ttdef"><b>Definition:</b> netRadiation.c:58</div></div>
<div class="ttc" id="abeps_8h_html_af808958823310e3a795c479ac996fdcf"><div class="ttname"><a href="beps_8h.html#af808958823310e3a795c479ac996fdcf">Leaf_Temperatures</a></div><div class="ttdeci">void Leaf_Temperatures(double Tair, double slope, double psychrometer, double VPD_air, double Cp_ca, double Gw_o_sunlit, double Gw_o_shaded, double Gw_u_sunlit, double Gw_u_shaded, double Gww_o_sunlit, double Gww_o_shaded, double Gww_u_sunlit, double Gww_u_shaded, double Gh_o_sunlit, double Gh_o_shaded, double Gh_u_sunlit, double Gh_u_shaded, double Xcs_o, double Xcl_o, double Xcs_u, double Xcl_u, double radiation_o_sun, double radiation_o_shaded, double radiation_u_sun, double radiation_u_shaded, double *Tc_o_sunlit, double *Tc_o_shaded, double *Tc_u_sunlit, double *Tc_u_shaded)</div><div class="ttdoc">Function to calculate leaf temperature four components (sunlit and shaded leaves, overstory and under...</div><div class="ttdef"><b>Definition:</b> calc_temp_leaf.c:48</div></div>
<div class="ttc" id="abeps_8h_html_afe6bee973e8941b047b6da31abd2fd40"><div class="ttname"><a href="beps_8h.html#afe6bee973e8941b047b6da31abd2fd40">sensible_heat</a></div><div class="ttdeci">void sensible_heat(double tempL_o_sunlit, double tempL_o_shaded, double tempL_u_sunlit, double tempL_u_shaded, double temp_g, double temp_air, double rh_air, double Gheat_o_sunlit, double Gheat_o_shaded, double Gheat_u_sunlit, double Gheat_u_shaded, double Gheat_g, double lai_o_sunlit, double lai_o_shaded, double lai_u_sunlit, double lai_u_shaded, double *SH_o, double *SH_u, double *SH_g)</div><div class="ttdoc">Function to calculate sensible heat.</div><div class="ttdef"><b>Definition:</b> sensible_heat.c:38</div></div>
<div class="ttc" id="areadcoef_8c_html_ac99693f8638c0217c08f940706ee460a"><div class="ttname"><a href="readcoef_8c.html#ac99693f8638c0217c08f940706ee460a">readcoef</a></div><div class="ttdeci">void readcoef(int short lc, int stxt, double *coef)</div><div class="ttdoc">Function to set soil coefficients.</div><div class="ttdef"><b>Definition:</b> readcoef.c:15</div></div>
<div class="ttc" id="areadparam_8c_html_ad34cd72fb7420cfa1aace172816d76b2"><div class="ttname"><a href="readparam_8c.html#ad34cd72fb7420cfa1aace172816d76b2">readparam</a></div><div class="ttdeci">void readparam(short lc, double *parameter1)</div><div class="ttdoc">Function to set parameters.</div><div class="ttdef"><b>Definition:</b> readparam.c:13</div></div>
<div class="ttc" id="asoil_8h_html"><div class="ttname"><a href="soil_8h.html">soil.h</a></div><div class="ttdoc">Header file for soil struct.</div></div>
<div class="ttc" id="astruct_soil_html"><div class="ttname"><a href="struct_soil.html">Soil</a></div><div class="ttdoc">Define soil struct.</div><div class="ttdef"><b>Definition:</b> soil.h:21</div></div>
<div class="ttc" id="astructclimatedata_html"><div class="ttname"><a href="structclimatedata.html">climatedata</a></div><div class="ttdoc">Declare structures.</div><div class="ttdef"><b>Definition:</b> beps.h:43</div></div>
<div class="ttc" id="astructcpools_html"><div class="ttname"><a href="structcpools.html">cpools</a></div><div class="ttdef"><b>Definition:</b> beps.h:78</div></div>
<div class="ttc" id="astructresults_html"><div class="ttname"><a href="structresults.html">results</a></div><div class="ttdef"><b>Definition:</b> beps.h:58</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
