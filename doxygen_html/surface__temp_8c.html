<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Boreal Ecosystem Productivity Simulator Hourly v4.10: surface_temp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Boreal Ecosystem Productivity Simulator Hourly v4.10
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">surface_temp.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This module will simulate surface temperature in each step, as well as heat flux form surface to soil layers.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="beps_8h_source.html">beps.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a543a621a86a39d5edf09723ff7252571"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="surface__temp_8c.html#a543a621a86a39d5edf09723ff7252571">surface_temperature</a> (double temp_air, double rh_air, double depth_snow, double depth_water, double capacity_heat_soil1, double capacity_heat_soil0, double Gheat_g, double depth_soil1, double density_snow, double tempL_u, double netRad_g, double evapo_soil, double evapo_water_g, double evapo_snow_g, double lambda_soil1, double percent_snow_g, double heat_flux_soil1, double temp_ground_last, double temp_soil1_last, double temp_any0_last, double temp_snow_last, double temp_soil0_last, double temp_snow1_last, double temp_snow2_last, double *temp_ground, double *temp_any0, double *temp_snow, double *temp_soil0, double *temp_snow1, double *temp_snow2, double *heat_flux)</td></tr>
<tr class="memdesc:a543a621a86a39d5edf09723ff7252571"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to simulate surface temperature, and heat flux from surface to soil layers.  <a href="surface__temp_8c.html#a543a621a86a39d5edf09723ff7252571">More...</a><br /></td></tr>
<tr class="separator:a543a621a86a39d5edf09723ff7252571"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >This module will simulate surface temperature in each step, as well as heat flux form surface to soil layers. </p>
<p >As it is an interface between ground, air and soil, the core idea is to separate the interface as different layers by depth of snow, then calculate the temperature gradient and at last calculate the heat flux from ground surface to soil.</p>
<p >Original beps would use Xg_snow[kkk] at some places after snow melt &amp; frozen, now we uniformly use the value before snow melt &amp; frozen. </p><dl class="section author"><dt>Author</dt><dd>Edited by XZ Luo </dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 1, 2015 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a543a621a86a39d5edf09723ff7252571" name="a543a621a86a39d5edf09723ff7252571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a543a621a86a39d5edf09723ff7252571">&#9670;&nbsp;</a></span>surface_temperature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void surface_temperature </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rh_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>depth_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>depth_water</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>capacity_heat_soil1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>capacity_heat_soil0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gheat_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>depth_soil1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>density_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>netRad_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo_soil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo_water_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo_snow_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lambda_soil1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>percent_snow_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heat_flux_soil1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_ground_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_soil1_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_any0_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_snow_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_soil0_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_snow1_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_snow2_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_ground</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_any0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_soil0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_snow1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_snow2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>heat_flux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to simulate surface temperature, and heat flux from surface to soil layers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temp_air</td><td>air temperature (Celsius degree) </td></tr>
    <tr><td class="paramname">rh_air</td><td>relative humidity (0-100) </td></tr>
    <tr><td class="paramname">depth_snow</td><td>depth of snow (m) </td></tr>
    <tr><td class="paramname">depth_water</td><td>depth of water on ground (m) </td></tr>
    <tr><td class="paramname">capacity_heat_soil1</td><td>heat capacity of layer1 soil (J/m2/K) </td></tr>
    <tr><td class="paramname">capacity_heat_soil0</td><td>heat capacity of layer2 soil (J/m2/K) </td></tr>
    <tr><td class="paramname">Gheat_g</td><td>aerodynamic conductance of heat on ground (m/s) </td></tr>
    <tr><td class="paramname">depth_soil1</td><td>depth of soil in layer1 (m) </td></tr>
    <tr><td class="paramname">density_snow</td><td>density of snow (kg/m3) </td></tr>
    <tr><td class="paramname">tempL_u</td><td>leaf temperature, understory (Celsius degree) </td></tr>
    <tr><td class="paramname">netRad_g</td><td>net radiation on ground (W/m2) </td></tr>
    <tr><td class="paramname">evapo_soil</td><td>evaporation from soil surface (mm/s) </td></tr>
    <tr><td class="paramname">evapo_water_g</td><td>evaporation from pond water on ground (mm/s) </td></tr>
    <tr><td class="paramname">evapo_snow_g</td><td>evaporation from snow pack on ground (mm/s) </td></tr>
    <tr><td class="paramname">lambda_soil1</td><td>thermal conductivity of layer1 soil (W/m/K) </td></tr>
    <tr><td class="paramname">percent_snow_g</td><td>percentage of snow coverage on ground (0-1) </td></tr>
    <tr><td class="paramname">heat_flux_soil1</td><td>heat flux from layer1 soil to the next soil layer (W/m2) </td></tr>
    <tr><td class="paramname">temp_ground_last</td><td>temperature of ground, from last step </td></tr>
    <tr><td class="paramname">temp_soil1_last</td><td>temperature of layer1 soil, from last step </td></tr>
    <tr><td class="paramname">temp_any0_last</td><td>temperature of any layer right above the soil, from last step </td></tr>
    <tr><td class="paramname">temp_snow_last</td><td>temperature of snow, from last step </td></tr>
    <tr><td class="paramname">temp_soil0_last</td><td>temperature of soil0, from last step </td></tr>
    <tr><td class="paramname">temp_snow1_last</td><td>temperature of snow layer 2, from last step </td></tr>
    <tr><td class="paramname">temp_snow2_last</td><td>temperature of snow layer 3, from last step </td></tr>
    <tr><td class="paramname">temp_ground</td><td>ground temperature at this step </td></tr>
    <tr><td class="paramname">temp_any0</td><td>temperature of any layer right above the soil could be a mixture of snow temperature and soil surface temperature </td></tr>
    <tr><td class="paramname">temp_snow</td><td>snow temperature at this step </td></tr>
    <tr><td class="paramname">temp_soil0</td><td>temperature of soil surface right above the soil, the part not covered by snow </td></tr>
    <tr><td class="paramname">temp_snow1</td><td>temperature of snow layer 2, used in depth_snow&gt;0.05 m </td></tr>
    <tr><td class="paramname">temp_snow2</td><td>temperature of snow layer 3, used in depth_snow&gt;0.05 m </td></tr>
    <tr><td class="paramname">heat_flux</td><td>heat flux from ground to soil </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
