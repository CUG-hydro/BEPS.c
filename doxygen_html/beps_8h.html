<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Boreal Ecosystem Productivity Simulator Hourly v4.10: beps.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Boreal Ecosystem Productivity Simulator Hourly v4.10
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">beps.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Header file for defining constants and global variables for BEPS program.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="soil_8h_source.html">soil.h</a>&quot;</code><br />
</div>
<p><a href="beps_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structclimatedata.html">climatedata</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare structures.  <a href="structclimatedata.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structresults.html">results</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcpools.html">cpools</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7c8e007a5b28cfb6d606095153d7e764"><td class="memItemLeft" align="right" valign="top"><a id="a7c8e007a5b28cfb6d606095153d7e764" name="a7c8e007a5b28cfb6d606095153d7e764"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NOERROR</b>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a7c8e007a5b28cfb6d606095153d7e764"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define Constants. <br /></td></tr>
<tr class="separator:a7c8e007a5b28cfb6d606095153d7e764"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fe83ac76edc595f6b98cd4a4127aed5"><td class="memItemLeft" align="right" valign="top"><a id="a8fe83ac76edc595f6b98cd4a4127aed5" name="a8fe83ac76edc595f6b98cd4a4127aed5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ERROR</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a8fe83ac76edc595f6b98cd4a4127aed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a598a3330b3c21701223ee0ca14316eca"><td class="memItemLeft" align="right" valign="top"><a id="a598a3330b3c21701223ee0ca14316eca" name="a598a3330b3c21701223ee0ca14316eca"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PI</b>&#160;&#160;&#160;3.1415926</td></tr>
<tr class="separator:a598a3330b3c21701223ee0ca14316eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a361b1d0588e13a7b5994f24b40138ec0"><td class="memItemLeft" align="right" valign="top"><a id="a361b1d0588e13a7b5994f24b40138ec0" name="a361b1d0588e13a7b5994f24b40138ec0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>zero</b>&#160;&#160;&#160;0.0000000001</td></tr>
<tr class="separator:a361b1d0588e13a7b5994f24b40138ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affe776513b24d84b39af8ab0930fef7f"><td class="memItemLeft" align="right" valign="top"><a id="affe776513b24d84b39af8ab0930fef7f" name="affe776513b24d84b39af8ab0930fef7f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>max</b>(a,  b)&#160;&#160;&#160;((a)&gt;(b))?(a):(b)</td></tr>
<tr class="separator:affe776513b24d84b39af8ab0930fef7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6afabdc09a49a433ee19d8a9486056d"><td class="memItemLeft" align="right" valign="top"><a id="ac6afabdc09a49a433ee19d8a9486056d" name="ac6afabdc09a49a433ee19d8a9486056d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>min</b>(a,  b)&#160;&#160;&#160;((a)&lt;(b))?(a):(b)</td></tr>
<tr class="separator:ac6afabdc09a49a433ee19d8a9486056d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe29213e7bd39070d916c4953d6bc988"><td class="memItemLeft" align="right" valign="top"><a id="afe29213e7bd39070d916c4953d6bc988" name="afe29213e7bd39070d916c4953d6bc988"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>l_sta</b>&#160;&#160;&#160;105</td></tr>
<tr class="separator:afe29213e7bd39070d916c4953d6bc988"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e3f5ded7e6d64227dc0690e4d88f39e"><td class="memItemLeft" align="right" valign="top"><a id="a4e3f5ded7e6d64227dc0690e4d88f39e" name="a4e3f5ded7e6d64227dc0690e4d88f39e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>l_end</b>&#160;&#160;&#160;105</td></tr>
<tr class="separator:a4e3f5ded7e6d64227dc0690e4d88f39e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fde173c7dff4736e7da2492314732ac"><td class="memItemLeft" align="right" valign="top"><a id="a4fde173c7dff4736e7da2492314732ac" name="a4fde173c7dff4736e7da2492314732ac"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>p_sta</b>&#160;&#160;&#160;101</td></tr>
<tr class="separator:a4fde173c7dff4736e7da2492314732ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a500be8d7db5d225e4d069f20b733171e"><td class="memItemLeft" align="right" valign="top"><a id="a500be8d7db5d225e4d069f20b733171e" name="a500be8d7db5d225e4d069f20b733171e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>p_end</b>&#160;&#160;&#160;101</td></tr>
<tr class="separator:a500be8d7db5d225e4d069f20b733171e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2bcbd56af4787bad097211b434131fb"><td class="memItemLeft" align="right" valign="top"><a id="ae2bcbd56af4787bad097211b434131fb" name="ae2bcbd56af4787bad097211b434131fb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RTIMES</b>&#160;&#160;&#160;24</td></tr>
<tr class="separator:ae2bcbd56af4787bad097211b434131fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc973eaddbc4136b2d75ebe2858303ec"><td class="memItemLeft" align="right" valign="top"><a id="afc973eaddbc4136b2d75ebe2858303ec" name="afc973eaddbc4136b2d75ebe2858303ec"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>step</b>&#160;&#160;&#160;3600</td></tr>
<tr class="separator:afc973eaddbc4136b2d75ebe2858303ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36260f398e55dd1c3500600057f9ec50"><td class="memItemLeft" align="right" valign="top"><a id="a36260f398e55dd1c3500600057f9ec50" name="a36260f398e55dd1c3500600057f9ec50"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>kstep</b>&#160;&#160;&#160;360</td></tr>
<tr class="separator:a36260f398e55dd1c3500600057f9ec50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0119596c044feb70ed60b4101f558bef"><td class="memItemLeft" align="right" valign="top"><a id="a0119596c044feb70ed60b4101f558bef" name="a0119596c044feb70ed60b4101f558bef"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>kloop</b>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a0119596c044feb70ed60b4101f558bef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9bf831d46a126f1e345628966a21784"><td class="memItemLeft" align="right" valign="top"><a id="ae9bf831d46a126f1e345628966a21784" name="ae9bf831d46a126f1e345628966a21784"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>layer</b>&#160;&#160;&#160;5</td></tr>
<tr class="separator:ae9bf831d46a126f1e345628966a21784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec749eddec0fc4172c16bb709cad5630"><td class="memItemLeft" align="right" valign="top"><a id="aec749eddec0fc4172c16bb709cad5630" name="aec749eddec0fc4172c16bb709cad5630"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>depth_f</b>&#160;&#160;&#160;6</td></tr>
<tr class="separator:aec749eddec0fc4172c16bb709cad5630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e7d7236ef81579cbfcb047b0cf2885f"><td class="memItemLeft" align="right" valign="top"><a id="a5e7d7236ef81579cbfcb047b0cf2885f" name="a5e7d7236ef81579cbfcb047b0cf2885f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CO2_air</b>&#160;&#160;&#160;380</td></tr>
<tr class="separator:a5e7d7236ef81579cbfcb047b0cf2885f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d753a2f4270107d646be18cacc69353"><td class="memItemLeft" align="right" valign="top"><a id="a4d753a2f4270107d646be18cacc69353" name="a4d753a2f4270107d646be18cacc69353"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>rho_a</b>&#160;&#160;&#160;1.292</td></tr>
<tr class="separator:a4d753a2f4270107d646be18cacc69353"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3c72265f8029e562b04497c536cdbc45"><td class="memItemLeft" align="right" valign="top"><a id="a3c72265f8029e562b04497c536cdbc45" name="a3c72265f8029e562b04497c536cdbc45"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>readconf</b> ()</td></tr>
<tr class="memdesc:a3c72265f8029e562b04497c536cdbc45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare functions. <br /></td></tr>
<tr class="separator:a3c72265f8029e562b04497c536cdbc45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a303e6700c3260946d8ea0450c84ed73b"><td class="memItemLeft" align="right" valign="top"><a id="a303e6700c3260946d8ea0450c84ed73b" name="a303e6700c3260946d8ea0450c84ed73b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mid_prg</b> ()</td></tr>
<tr class="separator:a303e6700c3260946d8ea0450c84ed73b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3019153d246a2059419f1d2b0f5b4b1a"><td class="memItemLeft" align="right" valign="top"><a id="a3019153d246a2059419f1d2b0f5b4b1a" name="a3019153d246a2059419f1d2b0f5b4b1a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>readinput1</b> ()</td></tr>
<tr class="separator:a3019153d246a2059419f1d2b0f5b4b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77fb80a6937219a06a3914c9b4f802aa"><td class="memItemLeft" align="right" valign="top"><a id="a77fb80a6937219a06a3914c9b4f802aa" name="a77fb80a6937219a06a3914c9b4f802aa"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>readlai_d</b> ()</td></tr>
<tr class="separator:a77fb80a6937219a06a3914c9b4f802aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bfac69aa5266d793b6142623fe6b959"><td class="memItemLeft" align="right" valign="top"><a id="a3bfac69aa5266d793b6142623fe6b959" name="a3bfac69aa5266d793b6142623fe6b959"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>readlonlat</b> ()</td></tr>
<tr class="separator:a3bfac69aa5266d793b6142623fe6b959"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c02a3b86f67a8fae214acd97445ba1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a6c02a3b86f67a8fae214acd97445ba1c">inter_prg</a> (int jday, int rstep, double lai, double clumping, double parameter[], struct <a class="el" href="structclimatedata.html">climatedata</a> *meteo, double CosZs, double var_o[], double var_n[], struct <a class="el" href="struct_soil.html">Soil</a> *soilp, struct <a class="el" href="structresults.html">results</a> *mid_res)</td></tr>
<tr class="memdesc:a6c02a3b86f67a8fae214acd97445ba1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">the inter-module function between main program and modules  <a href="beps_8h.html#a6c02a3b86f67a8fae214acd97445ba1c">More...</a><br /></td></tr>
<tr class="separator:a6c02a3b86f67a8fae214acd97445ba1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0fb52abdb8d4443b5f924713f66c6d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#ac0fb52abdb8d4443b5f924713f66c6d1">s_coszs</a> (short jday, short j, float lat, float lon, double *CosZs)</td></tr>
<tr class="memdesc:ac0fb52abdb8d4443b5f924713f66c6d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate cosine solar zenith angle.  <a href="beps_8h.html#ac0fb52abdb8d4443b5f924713f66c6d1">More...</a><br /></td></tr>
<tr class="separator:ac0fb52abdb8d4443b5f924713f66c6d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fb71e86f2d017c75626675ced14bb9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a6fb71e86f2d017c75626675ced14bb9c">aerodynamic_conductance</a> (double canopy_height_o, double canopy_height_u, double zz, double clumping, double temp_air, double wind_sp, double SH_o_p, double lai_o, double lai_u, double *rm, double *ra_u, double *ra_g, double *G_o_a, double *G_o_b, double *G_u_a, double *G_u_b)</td></tr>
<tr class="memdesc:a6fb71e86f2d017c75626675ced14bb9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate aerodynamic resistance and conductance.  <a href="beps_8h.html#a6fb71e86f2d017c75626675ced14bb9c">More...</a><br /></td></tr>
<tr class="separator:a6fb71e86f2d017c75626675ced14bb9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fc871429841fb77b43893474a5e0451"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a5fc871429841fb77b43893474a5e0451">plantresp</a> (int LC, struct <a class="el" href="structresults.html">results</a> *mid_res, double lai_yr, double lai, double temp_air, double temp_soil, double CosZs)</td></tr>
<tr class="memdesc:a5fc871429841fb77b43893474a5e0451"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate plant respiration.  <a href="beps_8h.html#a5fc871429841fb77b43893474a5e0451">More...</a><br /></td></tr>
<tr class="separator:a5fc871429841fb77b43893474a5e0451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fbeeca1b348f3732bdb2620e0be8937"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a5fbeeca1b348f3732bdb2620e0be8937">Vcmax_Jmax</a> (double lai_o, double clumping, double Vcmax0, double slope_Vcmax_N, double leaf_N, double CosZs, double *Vcmax_sunlit, double *Vcmax_shaded, double *Jmax_sunlit, double *Jmax_shaded)</td></tr>
<tr class="memdesc:a5fbeeca1b348f3732bdb2620e0be8937"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the Vcmax and Jmax for sunlit and shaded leaf.  <a href="beps_8h.html#a5fbeeca1b348f3732bdb2620e0be8937">More...</a><br /></td></tr>
<tr class="separator:a5fbeeca1b348f3732bdb2620e0be8937"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0512f7c2c7920479e2f293a8047363e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#ad0512f7c2c7920479e2f293a8047363e">netRadiation</a> (double shortRad_global, double CosZs, double temp_o, double temp_u, double temp_g, double lai_o, double lai_u, double lai_os, double lai_us, double lai_o_sunlit, double lai_o_shaded, double lai_u_sunlit, double lai_u_shaded, double clumping, double temp_air, double rh, double albedo_snow_v, double albedo_snow_n, double percentArea_snow_o, double percentArea_snow_u, double percent_snow_g, double albedo_v_o, double albedo_n_o, double albedo_v_u, double albedo_n_u, double albedo_v_g, double albedo_n_g, double *netRad_o, double *netRad_u, double *netRad_g, double *netRadLeaf_o_sunlit, double *netRadLeaf_o_shaded, double *netRadLeaf_u_sunlit, double *netRadLeaf_u_shaded, double *netShortRadLeaf_o_sunlit, double *netShortRadLeaf_o_shaded, double *netShortRadLeaf_u_sunlit, double *netShortRadLeaf_u_shaded)</td></tr>
<tr class="memdesc:ad0512f7c2c7920479e2f293a8047363e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate net radiation at canopy level and leaf level.  <a href="beps_8h.html#ad0512f7c2c7920479e2f293a8047363e">More...</a><br /></td></tr>
<tr class="separator:ad0512f7c2c7920479e2f293a8047363e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7385d5d0240cacc36b46e53f792656ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a7385d5d0240cacc36b46e53f792656ed">soilresp</a> (double *Ccd, double *Cssd, double *Csmd, double *Cfsd, double *Cfmd, double *Csm, double *Cm, double *Cs, double *Cp, float npp_yr, double *coef, int soiltype, struct <a class="el" href="struct_soil.html">Soil</a> *soilp, struct <a class="el" href="structresults.html">results</a> *mid_res)</td></tr>
<tr class="memdesc:a7385d5d0240cacc36b46e53f792656ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate soil respiration.  <a href="beps_8h.html#a7385d5d0240cacc36b46e53f792656ed">More...</a><br /></td></tr>
<tr class="separator:a7385d5d0240cacc36b46e53f792656ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a94120a2ce3af9b7650e692e0da4a44"><td class="memItemLeft" align="right" valign="top"><a id="a8a94120a2ce3af9b7650e692e0da4a44" name="a8a94120a2ce3af9b7650e692e0da4a44"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>readparam</b> (short lc, double parameter1[])</td></tr>
<tr class="separator:a8a94120a2ce3af9b7650e692e0da4a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fc64f22e38f438d7af776304aad554a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a1fc64f22e38f438d7af776304aad554a">lai2</a> (double stem_o, double stem_u, int LC, double CosZs, double lai_o, double clumping, double lai_u, double *lai_o_sunlit, double *lai_o_shaded, double *lai_u_sunlit, double *lai_u_shaded, double *PAI_o_sunlit, double *PAI_o_shaded, double *PAI_u_sunlit, double *PAI_u_shaded)</td></tr>
<tr class="memdesc:a1fc64f22e38f438d7af776304aad554a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to recalculate sunlit and shaded leaf area index.  <a href="beps_8h.html#a1fc64f22e38f438d7af776304aad554a">More...</a><br /></td></tr>
<tr class="separator:a1fc64f22e38f438d7af776304aad554a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5009f613e456431b5ca7a25ae8069b17"><td class="memItemLeft" align="right" valign="top"><a id="a5009f613e456431b5ca7a25ae8069b17" name="a5009f613e456431b5ca7a25ae8069b17"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>readcoef</b> (short lc, int stxt, double coef[])</td></tr>
<tr class="separator:a5009f613e456431b5ca7a25ae8069b17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb4131c46ce05b31aed317e2f88ba69"><td class="memItemLeft" align="right" valign="top"><a id="affb4131c46ce05b31aed317e2f88ba69" name="affb4131c46ce05b31aed317e2f88ba69"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>readhydr_param</b> ()</td></tr>
<tr class="separator:affb4131c46ce05b31aed317e2f88ba69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d88c03d1b3c21080b3873f6c88bc02"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a63d88c03d1b3c21080b3873f6c88bc02">photosynthesis</a> (double temp_leaf_p, double rad_leaf, double e_air, double g_lb_w, double vc_opt, double f_soilwater, double b_h2o, double m_h2o, double cii, double temp_leaf_c, double LH_leaf, double *Gs_w, double *aphoto, double *ci)</td></tr>
<tr class="memdesc:a63d88c03d1b3c21080b3873f6c88bc02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate leaf photosynthesis by solving a cubic equation.  <a href="beps_8h.html#a63d88c03d1b3c21080b3873f6c88bc02">More...</a><br /></td></tr>
<tr class="separator:a63d88c03d1b3c21080b3873f6c88bc02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafe73fe613f2ddc6f0cce1a64f7f0555"><td class="memItemLeft" align="right" valign="top"><a id="aafe73fe613f2ddc6f0cce1a64f7f0555" name="aafe73fe613f2ddc6f0cce1a64f7f0555"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>soil_water_factor</b> ()</td></tr>
<tr class="separator:aafe73fe613f2ddc6f0cce1a64f7f0555"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af808958823310e3a795c479ac996fdcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#af808958823310e3a795c479ac996fdcf">Leaf_Temperatures</a> (double Tair, double slope, double psychrometer, double VPD_air, double Cp_ca, double Gw_o_sunlit, double Gw_o_shaded, double Gw_u_sunlit, double Gw_u_shaded, double Gww_o_sunlit, double Gww_o_shaded, double Gww_u_sunlit, double Gww_u_shaded, double Gh_o_sunlit, double Gh_o_shaded, double Gh_u_sunlit, double Gh_u_shaded, double Xcs_o, double Xcl_o, double Xcs_u, double Xcl_u, double radiation_o_sun, double radiation_o_shaded, double radiation_u_sun, double radiation_u_shaded, double *Tc_o_sunlit, double *Tc_o_shaded, double *Tc_u_sunlit, double *Tc_u_shaded)</td></tr>
<tr class="memdesc:af808958823310e3a795c479ac996fdcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate leaf temperature four components (sunlit and shaded leaves, overstory and understory)  <a href="beps_8h.html#af808958823310e3a795c479ac996fdcf">More...</a><br /></td></tr>
<tr class="separator:af808958823310e3a795c479ac996fdcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e60526f2328237683e1039745ed0392"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a0e60526f2328237683e1039745ed0392">Leaf_Temperature</a> (double Tair, double slope, double psychrometer, double VPD_air, double Cp_ca, double Gw, double Gww, double Gh, double Xcs, double Xcl, double radiation)</td></tr>
<tr class="memdesc:a0e60526f2328237683e1039745ed0392"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate leaf temperature.  <a href="beps_8h.html#a0e60526f2328237683e1039745ed0392">More...</a><br /></td></tr>
<tr class="separator:a0e60526f2328237683e1039745ed0392"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe6bee973e8941b047b6da31abd2fd40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#afe6bee973e8941b047b6da31abd2fd40">sensible_heat</a> (double tempL_o_sunlit, double tempL_o_shaded, double tempL_u_sunlit, double tempL_u_shaded, double temp_g, double temp_air, double rh_air, double Gheat_o_sunlit, double Gheat_o_shaded, double Gheat_u_sunlit, double Gheat_u_shaded, double Gheat_g, double lai_o_sunlit, double lai_o_shaded, double lai_u_sunlit, double lai_u_shaded, double *SH_o, double *SH_u, double *SH_g)</td></tr>
<tr class="memdesc:afe6bee973e8941b047b6da31abd2fd40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate sensible heat.  <a href="beps_8h.html#afe6bee973e8941b047b6da31abd2fd40">More...</a><br /></td></tr>
<tr class="separator:afe6bee973e8941b047b6da31abd2fd40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fb46fbf5ca3c002533cbc36bf8dbe3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a8fb46fbf5ca3c002533cbc36bf8dbe3a">transpiration</a> (double tempL_o_sunlit, double tempL_o_shaded, double tempL_u_sunlit, double tempL_u_shaded, double temp_air, double rh_air, double Gtrans_o_sunlit, double Gtrans_o_shaded, double Gtrans_u_sunlit, double Gtrans_u_shaded, double lai_o_sunlit, double lai_o_shaded, double lai_u_sunlit, double lai_u_shaded, double *trans_o, double *trans_u)</td></tr>
<tr class="memdesc:a8fb46fbf5ca3c002533cbc36bf8dbe3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate transpiration.  <a href="beps_8h.html#a8fb46fbf5ca3c002533cbc36bf8dbe3a">More...</a><br /></td></tr>
<tr class="separator:a8fb46fbf5ca3c002533cbc36bf8dbe3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e461617f7d17b9327a7f637244a496"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a18e461617f7d17b9327a7f637244a496">evaporation_canopy</a> (double tempL_o_sunlit, double tempL_o_shaded, double tempL_u_sunlit, double tempL_u_shaded, double temp_air, double rh_air, double Gwater_o_sunlit, double Gwater_o_shaded, double Gwater_u_sunlit, double Gwater_u_shaded, double lai_o_sunlit, double lai_o_shaded, double lai_u_sunlit, double lai_u_shaded, double percent_water_o, double percent_water_u, double percent_snow_o, double percent_snow_u, double *evapo_water_o, double *evapo_water_u, double *evapo_snow_o, double *evapo_snow_u)</td></tr>
<tr class="memdesc:a18e461617f7d17b9327a7f637244a496"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate evaporation and sublimation from canopy.  <a href="beps_8h.html#a18e461617f7d17b9327a7f637244a496">More...</a><br /></td></tr>
<tr class="separator:a18e461617f7d17b9327a7f637244a496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d0775f289240bf05f662483b6ad6b32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a8d0775f289240bf05f662483b6ad6b32">evaporation_soil</a> (double temp_air, double temp_g, double rh_air, double netRad_g, double Gheat_g, double *percent_snow_g, double *depth_water, double *depth_snow, double *mass_water_g, double *mass_snow_g, double density_snow, double swc_g, double porosity_g, double *evapo_soil, double *evapo_water_g, double *evapo_snow_g)</td></tr>
<tr class="memdesc:a8d0775f289240bf05f662483b6ad6b32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate evaporation from ground surface/top soil, and the evaporation of snow and pond water on surface.  <a href="beps_8h.html#a8d0775f289240bf05f662483b6ad6b32">More...</a><br /></td></tr>
<tr class="separator:a8d0775f289240bf05f662483b6ad6b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62a1eec9667a887e1a9bfd32a56ea67c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a62a1eec9667a887e1a9bfd32a56ea67c">rainfall_stage1</a> (double temp_air, double precipitation, double mass_water_o_last, double mass_water_u_last, double lai_o, double lai_u, double clumping, double *mass_water_o, double *mass_water_u, double *percent_water_o, double *percent_water_u, double *precipitation_g)</td></tr>
<tr class="memdesc:a62a1eec9667a887e1a9bfd32a56ea67c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function of rainfall stage1.  <a href="beps_8h.html#a62a1eec9667a887e1a9bfd32a56ea67c">More...</a><br /></td></tr>
<tr class="separator:a62a1eec9667a887e1a9bfd32a56ea67c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b417e26208501b9cbcc8576b136e598"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a5b417e26208501b9cbcc8576b136e598">rainfall_stage2</a> (double evapo_water_o, double evapo_water_u, double *mass_water_o, double *mass_water_u)</td></tr>
<tr class="memdesc:a5b417e26208501b9cbcc8576b136e598"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function of rainfall stage2.  <a href="beps_8h.html#a5b417e26208501b9cbcc8576b136e598">More...</a><br /></td></tr>
<tr class="separator:a5b417e26208501b9cbcc8576b136e598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02287051ec892e93ce6bb4adf46cbce0"><td class="memItemLeft" align="right" valign="top"><a id="a02287051ec892e93ce6bb4adf46cbce0" name="a02287051ec892e93ce6bb4adf46cbce0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>rainfall_stage3</b> ()</td></tr>
<tr class="separator:a02287051ec892e93ce6bb4adf46cbce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74d0e9f235b59eaf094a63d6e697c8e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a74d0e9f235b59eaf094a63d6e697c8e3">meteo_pack</a> (double temp, double rh, double *meteo_pack_output)</td></tr>
<tr class="memdesc:a74d0e9f235b59eaf094a63d6e697c8e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate meteorological variables based on input.  <a href="beps_8h.html#a74d0e9f235b59eaf094a63d6e697c8e3">More...</a><br /></td></tr>
<tr class="separator:a74d0e9f235b59eaf094a63d6e697c8e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a543a621a86a39d5edf09723ff7252571"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a543a621a86a39d5edf09723ff7252571">surface_temperature</a> (double temp_air, double rh_air, double depth_snow, double depth_water, double capacity_heat_soil1, double capacity_heat_soil0, double Gheat_g, double depth_soil1, double density_snow, double tempL_u, double netRad_g, double evapo_soil, double evapo_water_g, double evapo_snow_g, double lambda_soil1, double percent_snow_g, double heat_flux_soil1, double temp_ground_last, double temp_soil1_last, double temp_any0_last, double temp_snow_last, double temp_soil0_last, double temp_snow1_last, double temp_snow2_last, double *temp_ground, double *temp_any0, double *temp_snow, double *temp_soil0, double *temp_snow1, double *temp_snow2, double *heat_flux)</td></tr>
<tr class="memdesc:a543a621a86a39d5edf09723ff7252571"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to simulate surface temperature, and heat flux from surface to soil layers.  <a href="beps_8h.html#a543a621a86a39d5edf09723ff7252571">More...</a><br /></td></tr>
<tr class="separator:a543a621a86a39d5edf09723ff7252571"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7970c5267f32a503569127e3ba702edd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a7970c5267f32a503569127e3ba702edd">snowpack_stage1</a> (double temp_air, double precipitation, double mass_snow_o_last, double mass_snow_u_last, double mass_snow_g_last, double *mass_snow_o, double *mass_snow_u, double *mass_snow_g, double lai_o, double lai_u, double clumping, double *area_snow_o, double *area_snow_u, double *percent_snow_o, double *percent_snow_u, double *percent_snow_g, double *density_snow, double *depth_snow, double *albedo_v_snow, double *albedo_n_snow)</td></tr>
<tr class="memdesc:a7970c5267f32a503569127e3ba702edd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function of snowpack stage1.  <a href="beps_8h.html#a7970c5267f32a503569127e3ba702edd">More...</a><br /></td></tr>
<tr class="separator:a7970c5267f32a503569127e3ba702edd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d6185a683cfa4bcc98870f6108666bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a6d6185a683cfa4bcc98870f6108666bc">snowpack_stage2</a> (double evapo_snow_o, double evapo_snow_u, double *mass_snow_o, double *mass_snow_u)</td></tr>
<tr class="memdesc:a6d6185a683cfa4bcc98870f6108666bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function of snowpack stage2. This module will calculate the snow remained on canopy surface after evaporation in this step.  <a href="beps_8h.html#a6d6185a683cfa4bcc98870f6108666bc">More...</a><br /></td></tr>
<tr class="separator:a6d6185a683cfa4bcc98870f6108666bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21f2bf33a62ab7d7acba0decde33b961"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="beps_8h.html#a21f2bf33a62ab7d7acba0decde33b961">snowpack_stage3</a> (double temp_air, double temp_snow, double temp_snow_last, double density_snow, double *depth_snow, double *depth_water, double *mass_snow_g)</td></tr>
<tr class="memdesc:a21f2bf33a62ab7d7acba0decde33b961"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function of snowpack stage3. This module simulates the process of snow melting and water frozen in this step.  <a href="beps_8h.html#a21f2bf33a62ab7d7acba0decde33b961">More...</a><br /></td></tr>
<tr class="separator:a21f2bf33a62ab7d7acba0decde33b961"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8a3ae8ec94331c6db9ea5475817634ab"><td class="memItemLeft" align="right" valign="top"><a id="a8a3ae8ec94331c6db9ea5475817634ab" name="a8a3ae8ec94331c6db9ea5475817634ab"></a>
short&#160;</td><td class="memItemRight" valign="bottom"><b>lc_no</b></td></tr>
<tr class="memdesc:a8a3ae8ec94331c6db9ea5475817634ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare global variables. <br /></td></tr>
<tr class="separator:a8a3ae8ec94331c6db9ea5475817634ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af416042956e7e975ac8d099cc2112389"><td class="memItemLeft" align="right" valign="top"><a id="af416042956e7e975ac8d099cc2112389" name="af416042956e7e975ac8d099cc2112389"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>yr</b></td></tr>
<tr class="separator:af416042956e7e975ac8d099cc2112389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16eaa9a18a894b77f067fc5e542c709b"><td class="memItemLeft" align="right" valign="top"><a id="a16eaa9a18a894b77f067fc5e542c709b" name="a16eaa9a18a894b77f067fc5e542c709b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>bgn_day</b></td></tr>
<tr class="separator:a16eaa9a18a894b77f067fc5e542c709b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac95f06a49df5defa46d3d67fe4ab32c6"><td class="memItemLeft" align="right" valign="top"><a id="ac95f06a49df5defa46d3d67fe4ab32c6" name="ac95f06a49df5defa46d3d67fe4ab32c6"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>end_day</b></td></tr>
<tr class="separator:ac95f06a49df5defa46d3d67fe4ab32c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a694e3acd7cf60517b18b6ece6935e5"><td class="memItemLeft" align="right" valign="top"><a id="a3a694e3acd7cf60517b18b6ece6935e5" name="a3a694e3acd7cf60517b18b6ece6935e5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>npixels</b></td></tr>
<tr class="separator:a3a694e3acd7cf60517b18b6ece6935e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af69ee38d2c862dbc6769fa27c5320b96"><td class="memItemLeft" align="right" valign="top"><a id="af69ee38d2c862dbc6769fa27c5320b96" name="af69ee38d2c862dbc6769fa27c5320b96"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>nlines</b></td></tr>
<tr class="separator:af69ee38d2c862dbc6769fa27c5320b96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5881807c5ace09d35e99bf4ee86cc431"><td class="memItemLeft" align="right" valign="top"><a id="a5881807c5ace09d35e99bf4ee86cc431" name="a5881807c5ace09d35e99bf4ee86cc431"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>lc_fn</b> [255]</td></tr>
<tr class="separator:a5881807c5ace09d35e99bf4ee86cc431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb6dcf6e151442fcd6715b1f8fc7a47"><td class="memItemLeft" align="right" valign="top"><a id="afcb6dcf6e151442fcd6715b1f8fc7a47" name="afcb6dcf6e151442fcd6715b1f8fc7a47"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>lai_fn</b> [255]</td></tr>
<tr class="separator:afcb6dcf6e151442fcd6715b1f8fc7a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a851f13661b65594d7206b9512512e84a"><td class="memItemLeft" align="right" valign="top"><a id="a851f13661b65594d7206b9512512e84a" name="a851f13661b65594d7206b9512512e84a"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>lai_fp</b> [255]</td></tr>
<tr class="separator:a851f13661b65594d7206b9512512e84a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44e4b8ff27dbd54b8d801e527a4f505d"><td class="memItemLeft" align="right" valign="top"><a id="a44e4b8ff27dbd54b8d801e527a4f505d" name="a44e4b8ff27dbd54b8d801e527a4f505d"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>stxt_fn</b> [255]</td></tr>
<tr class="separator:a44e4b8ff27dbd54b8d801e527a4f505d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20e558b8eced9650a4d0f2b66b5d5bfb"><td class="memItemLeft" align="right" valign="top"><a id="a20e558b8eced9650a4d0f2b66b5d5bfb" name="a20e558b8eced9650a4d0f2b66b5d5bfb"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>ci_fn</b> [255]</td></tr>
<tr class="separator:a20e558b8eced9650a4d0f2b66b5d5bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcf489ee5a558470a0ce4f8b9a6057f1"><td class="memItemLeft" align="right" valign="top"><a id="abcf489ee5a558470a0ce4f8b9a6057f1" name="abcf489ee5a558470a0ce4f8b9a6057f1"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>st_fn</b> [255]</td></tr>
<tr class="separator:abcf489ee5a558470a0ce4f8b9a6057f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa69334c68e596e7015ae681b9d478092"><td class="memItemLeft" align="right" valign="top"><a id="aa69334c68e596e7015ae681b9d478092" name="aa69334c68e596e7015ae681b9d478092"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>sw_fn</b> [255]</td></tr>
<tr class="separator:aa69334c68e596e7015ae681b9d478092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a328965e16f63964357d4350894d2bfbe"><td class="memItemLeft" align="right" valign="top"><a id="a328965e16f63964357d4350894d2bfbe" name="a328965e16f63964357d4350894d2bfbe"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>sdp_fn</b> [255]</td></tr>
<tr class="separator:a328965e16f63964357d4350894d2bfbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f5c548829370f1d11610f9466030886"><td class="memItemLeft" align="right" valign="top"><a id="a2f5c548829370f1d11610f9466030886" name="a2f5c548829370f1d11610f9466030886"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>r_fn</b> [255]</td></tr>
<tr class="separator:a2f5c548829370f1d11610f9466030886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa59bd4db282409a5dfbea38131ee94f8"><td class="memItemLeft" align="right" valign="top"><a id="aa59bd4db282409a5dfbea38131ee94f8" name="aa59bd4db282409a5dfbea38131ee94f8"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>t_fn</b> [255]</td></tr>
<tr class="separator:aa59bd4db282409a5dfbea38131ee94f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc0bd0d8a50e54a3a08acbe851031eba"><td class="memItemLeft" align="right" valign="top"><a id="acc0bd0d8a50e54a3a08acbe851031eba" name="acc0bd0d8a50e54a3a08acbe851031eba"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>h_fn</b> [255]</td></tr>
<tr class="separator:acc0bd0d8a50e54a3a08acbe851031eba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebc2bdd9964ad056bfde35a1d833d467"><td class="memItemLeft" align="right" valign="top"><a id="aebc2bdd9964ad056bfde35a1d833d467" name="aebc2bdd9964ad056bfde35a1d833d467"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>p_fn</b> [255]</td></tr>
<tr class="separator:aebc2bdd9964ad056bfde35a1d833d467"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a526f218cc157362dc5b56df805ce49cf"><td class="memItemLeft" align="right" valign="top"><a id="a526f218cc157362dc5b56df805ce49cf" name="a526f218cc157362dc5b56df805ce49cf"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>wd_fn</b> [255]</td></tr>
<tr class="separator:a526f218cc157362dc5b56df805ce49cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5b9ee0794cf787abbb31eb9f230d0fe"><td class="memItemLeft" align="right" valign="top"><a id="ad5b9ee0794cf787abbb31eb9f230d0fe" name="ad5b9ee0794cf787abbb31eb9f230d0fe"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>lon_fn</b> [255]</td></tr>
<tr class="separator:ad5b9ee0794cf787abbb31eb9f230d0fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ad8c951db07c20d268aba49ed0d58d5"><td class="memItemLeft" align="right" valign="top"><a id="a4ad8c951db07c20d268aba49ed0d58d5" name="a4ad8c951db07c20d268aba49ed0d58d5"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>lat_fn</b> [255]</td></tr>
<tr class="separator:a4ad8c951db07c20d268aba49ed0d58d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5ba4f29b34d734f29fb71d060484277"><td class="memItemLeft" align="right" valign="top"><a id="af5ba4f29b34d734f29fb71d060484277" name="af5ba4f29b34d734f29fb71d060484277"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>fp4outp1</b> [255]</td></tr>
<tr class="separator:af5ba4f29b34d734f29fb71d060484277"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9cdf582d836c97ea3791b1f9efa1cdb"><td class="memItemLeft" align="right" valign="top"><a id="af9cdf582d836c97ea3791b1f9efa1cdb" name="af9cdf582d836c97ea3791b1f9efa1cdb"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>fp4outp2</b> [255]</td></tr>
<tr class="separator:af9cdf582d836c97ea3791b1f9efa1cdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87c1bf2620968296cf81b1aac331936a"><td class="memItemLeft" align="right" valign="top"><a id="a87c1bf2620968296cf81b1aac331936a" name="a87c1bf2620968296cf81b1aac331936a"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>fp4outp3</b> [255]</td></tr>
<tr class="separator:a87c1bf2620968296cf81b1aac331936a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Header file for defining constants and global variables for BEPS program. </p>
<p >CCRS (EMS/Applications Division)</p>
<dl class="section author"><dt>Author</dt><dd>Written by: J. Liu, Modified by: G. Mo </dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 2015 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6fb71e86f2d017c75626675ced14bb9c" name="a6fb71e86f2d017c75626675ced14bb9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fb71e86f2d017c75626675ced14bb9c">&#9670;&nbsp;</a></span>aerodynamic_conductance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aerodynamic_conductance </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>canopy_height_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>canopy_height_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>clumping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wind_sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SH_o_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ra_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ra_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>G_o_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>G_o_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>G_u_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>G_u_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate aerodynamic resistance and conductance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">canopy_height_o</td><td>canopy height, overstory </td></tr>
    <tr><td class="paramname">canopy_height_u</td><td>height of understory </td></tr>
    <tr><td class="paramname">zz</td><td>the height to measure wind speed </td></tr>
    <tr><td class="paramname">clumping</td><td>clumping index </td></tr>
    <tr><td class="paramname">temp_air</td><td>air temperature </td></tr>
    <tr><td class="paramname">wind_sp</td><td>wind speed </td></tr>
    <tr><td class="paramname">SH_o_p</td><td>sensible heat flux from overstory </td></tr>
    <tr><td class="paramname">lai_o</td><td>leaf area index, overstory (lai_o+stem_o) </td></tr>
    <tr><td class="paramname">lai_u</td><td>leaf area index, understory (lai_u+stem_u) </td></tr>
    <tr><td class="paramname">rm</td><td>aerodynamic resistance, overstory, in s/m </td></tr>
    <tr><td class="paramname">ra_u</td><td>aerodynamic resistance, understory, in s/m </td></tr>
    <tr><td class="paramname">ra_g</td><td>aerodynamic resistance, ground, in s/m </td></tr>
    <tr><td class="paramname">G_o_a</td><td>aerodynamic conductance for leaves, overstory </td></tr>
    <tr><td class="paramname">G_o_b</td><td>boundary layer conductance for leaves, overstory </td></tr>
    <tr><td class="paramname">G_u_a</td><td>aerodynamic conductance for leaves, understory </td></tr>
    <tr><td class="paramname">G_u_b</td><td>boundary layer conductance for leaves, understory </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a18e461617f7d17b9327a7f637244a496" name="a18e461617f7d17b9327a7f637244a496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18e461617f7d17b9327a7f637244a496">&#9670;&nbsp;</a></span>evaporation_canopy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evaporation_canopy </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rh_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gwater_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gwater_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gwater_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gwater_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>percent_water_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>percent_water_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>percent_snow_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>percent_snow_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>evapo_water_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>evapo_water_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>evapo_snow_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>evapo_snow_u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate evaporation and sublimation from canopy. </p>
<p >[input] temperature of sunlit and shaded leaves from other storey (leaf temperature module); temperature of air; relative humidity; aerodynamic conductance of water (snow) for sunlit shaded leaves from overstorey and understorey; percentage of overstorey or understorey covered by water or snow; leaf area index, sunlit and shaded, overstorey and understorey (from leaf area index module);</p>
<p >[output] evaporation of water and snow from overstorey and understorey </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tempL_o_sunlit</td><td>temperature of leaves, overstory, sunlit (leaf temperature module) </td></tr>
    <tr><td class="paramname">tempL_o_shaded</td><td>temperature of leaves, overstory, shaded </td></tr>
    <tr><td class="paramname">tempL_u_sunlit</td><td>temperature of leaves, understory, sunlit </td></tr>
    <tr><td class="paramname">tempL_u_shaded</td><td>temperature of leaves, understory, shaded </td></tr>
    <tr><td class="paramname">temp_air</td><td>air temperature </td></tr>
    <tr><td class="paramname">rh_air</td><td>relative humidity </td></tr>
    <tr><td class="paramname">Gwater_o_sunlit</td><td>aerodynamic conductance of water (snow) for overstory, sunlit leaves </td></tr>
    <tr><td class="paramname">Gwater_o_shaded</td><td>aerodynamic conductance of water (snow) for overstory, shaded leaves </td></tr>
    <tr><td class="paramname">Gwater_u_sunlit</td><td>aerodynamic conductance of water (snow) for understory, sunlit leaves </td></tr>
    <tr><td class="paramname">Gwater_u_shaded</td><td>aerodynamic conductance of water (snow) for understory, shaded leaves </td></tr>
    <tr><td class="paramname">lai_o_sunlit</td><td>leaf area index, overstory, sunlit (from leaf area index module) </td></tr>
    <tr><td class="paramname">lai_o_shaded</td><td>leaf area index, overstory, shaded </td></tr>
    <tr><td class="paramname">lai_u_sunlit</td><td>leaf area index, understory, sunlit </td></tr>
    <tr><td class="paramname">lai_u_shaded</td><td>leaf area index, understory, shaded </td></tr>
    <tr><td class="paramname">percent_water_o</td><td>percentage of overstorey covered by water </td></tr>
    <tr><td class="paramname">percent_water_u</td><td>percentage of understorey covered by water </td></tr>
    <tr><td class="paramname">percent_snow_o</td><td>percentage of overstorey covered by snow </td></tr>
    <tr><td class="paramname">percent_snow_u</td><td>percentage of understorey covered by snow </td></tr>
    <tr><td class="paramname">evapo_water_o</td><td>evaporation of water from overstorey </td></tr>
    <tr><td class="paramname">evapo_water_u</td><td>evaporation of water from understorey </td></tr>
    <tr><td class="paramname">evapo_snow_o</td><td>evaporation of snow from overstorey </td></tr>
    <tr><td class="paramname">evapo_snow_u</td><td>evaporation of snow from understorey </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a8d0775f289240bf05f662483b6ad6b32" name="a8d0775f289240bf05f662483b6ad6b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d0775f289240bf05f662483b6ad6b32">&#9670;&nbsp;</a></span>evaporation_soil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evaporation_soil </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rh_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>netRad_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gheat_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>percent_snow_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depth_water</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depth_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_water_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_snow_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>density_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>swc_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>porosity_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>evapo_soil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>evapo_water_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>evapo_snow_g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate evaporation from ground surface/top soil, and the evaporation of snow and pond water on surface. </p>
<p >[input] air temperature; ground surface temperature; relative humidity of ground (BEPS takes it as the air RH); percentage of snow cover on ground; depth of water; depth of snow soil water content on first soil layer; porosity of first soil layer</p>
<p >[output] evaporation from soil surface; depth of water and snow on ground after evaporation and sublimation </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temp_air</td><td>air temperature </td></tr>
    <tr><td class="paramname">temp_g</td><td>ground temperature </td></tr>
    <tr><td class="paramname">rh_air</td><td>relative humidity of air </td></tr>
    <tr><td class="paramname">netRad_g</td><td>net radiation on ground </td></tr>
    <tr><td class="paramname">Gheat_g</td><td>aerodynamic conductance of heat on ground surface </td></tr>
    <tr><td class="paramname">percent_snow_g</td><td>percentage of snow on ground </td></tr>
    <tr><td class="paramname">depth_water</td><td>depth of water on ground, after rainfall and snowfall stage 1, before evaporation. output after subtracting evaporation </td></tr>
    <tr><td class="paramname">depth_snow</td><td>depth of snow on ground, ... </td></tr>
    <tr><td class="paramname">mass_water_g</td><td>mass of water on ground, output after subtracting evaporation </td></tr>
    <tr><td class="paramname">mass_snow_g</td><td>mass of snow on ground, ... </td></tr>
    <tr><td class="paramname">density_snow</td><td>density of snow, from snowpack stage1 </td></tr>
    <tr><td class="paramname">swc_g</td><td>soil water content (from last step) </td></tr>
    <tr><td class="paramname">porosity_g</td><td>porosity on ground </td></tr>
    <tr><td class="paramname">evapo_soil</td><td>evaporation from soil </td></tr>
    <tr><td class="paramname">evapo_water_g</td><td>evaporation from pond water </td></tr>
    <tr><td class="paramname">evapo_snow_g</td><td>evaporation from snow on surface </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a6c02a3b86f67a8fae214acd97445ba1c" name="a6c02a3b86f67a8fae214acd97445ba1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c02a3b86f67a8fae214acd97445ba1c">&#9670;&nbsp;</a></span>inter_prg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void inter_prg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>jday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>clumping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>parameter</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structclimatedata.html">climatedata</a> *&#160;</td>
          <td class="paramname"><em>meteo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CosZs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>var_o</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>var_n</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_soil.html">Soil</a> *&#160;</td>
          <td class="paramname"><em>soilp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structresults.html">results</a> *&#160;</td>
          <td class="paramname"><em>mid_res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the inter-module function between main program and modules </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jday</td><td>day of year </td></tr>
    <tr><td class="paramname">rstep</td><td>hour of day </td></tr>
    <tr><td class="paramname">lai</td><td>leaf area index </td></tr>
    <tr><td class="paramname">clumping</td><td>clumping index </td></tr>
    <tr><td class="paramname">parameter</td><td>parameter array according to land cover types </td></tr>
    <tr><td class="paramname">meteo</td><td>meteorological data </td></tr>
    <tr><td class="paramname">CosZs</td><td>cosine of solar zenith angle </td></tr>
    <tr><td class="paramname">var_o</td><td>temporary variables array of last time step </td></tr>
    <tr><td class="paramname">var_n</td><td>temporary variables array of this time step </td></tr>
    <tr><td class="paramname">soilp</td><td>soil coefficients according to land cover types and soil textures </td></tr>
    <tr><td class="paramname">mid_res</td><td>results struct </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a1fc64f22e38f438d7af776304aad554a" name="a1fc64f22e38f438d7af776304aad554a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fc64f22e38f438d7af776304aad554a">&#9670;&nbsp;</a></span>lai2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lai2 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stem_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stem_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CosZs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>clumping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lai_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lai_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lai_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lai_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>PAI_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>PAI_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>PAI_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>PAI_u_shaded</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to recalculate sunlit and shaded leaf area index. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stem_o</td><td>overstory woody area </td></tr>
    <tr><td class="paramname">stem_u</td><td>understory woody area </td></tr>
    <tr><td class="paramname">LC</td><td>land cover type </td></tr>
    <tr><td class="paramname">CosZs</td><td>cosine solar zenith angle </td></tr>
    <tr><td class="paramname">lai_o</td><td>overstory lai </td></tr>
    <tr><td class="paramname">clumping</td><td>clumping index </td></tr>
    <tr><td class="paramname">lai_u</td><td>understory lai </td></tr>
    <tr><td class="paramname">lai_o_sunlit</td><td>overstory sunlit lai </td></tr>
    <tr><td class="paramname">lai_o_shaded</td><td>overstory shaded lai </td></tr>
    <tr><td class="paramname">lai_u_sunlit</td><td>understory sunlit lai </td></tr>
    <tr><td class="paramname">lai_u_shaded</td><td>understory shaded lai </td></tr>
    <tr><td class="paramname">PAI_o_sunlit</td><td>overstory sunlit lai </td></tr>
    <tr><td class="paramname">PAI_o_shaded</td><td>overstory shaded lai </td></tr>
    <tr><td class="paramname">PAI_u_sunlit</td><td>understory sunlit lai </td></tr>
    <tr><td class="paramname">PAI_u_shaded</td><td>understory shaded lai </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a0e60526f2328237683e1039745ed0392" name="a0e60526f2328237683e1039745ed0392"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e60526f2328237683e1039745ed0392">&#9670;&nbsp;</a></span>Leaf_Temperature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Leaf_Temperature </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>slope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psychrometer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>VPD_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cp_ca</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gww</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Xcs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Xcl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radiation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate leaf temperature. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Tair</td><td>air temperature </td></tr>
    <tr><td class="paramname">slope</td><td>the slope of saturation vapor pressure-temperature curve </td></tr>
    <tr><td class="paramname">psychrometer</td><td>psychrometer constant, 0.066 kPa K </td></tr>
    <tr><td class="paramname">VPD_air</td><td>vapor pressure deficit </td></tr>
    <tr><td class="paramname">Cp_ca</td><td>specific heat of moist air in kJ/kg/K </td></tr>
    <tr><td class="paramname">Gw</td><td>total conductance for water from the intercellular space of the leaves to the reference height above the canopy </td></tr>
    <tr><td class="paramname">Gww</td><td>total conductance for water from the surface of the leaves to the reference height above the canopy </td></tr>
    <tr><td class="paramname">Gh</td><td>total conductance for heat transfer from the leaf surface to the reference height above the canopy </td></tr>
    <tr><td class="paramname">Xcs</td><td>the fraction of canopy covered by snow </td></tr>
    <tr><td class="paramname">Xcl</td><td>the fraction of canopy covered by liquid water </td></tr>
    <tr><td class="paramname">radiation</td><td>net radiation on leaves </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[double Tc] the effective canopy temperature in Kalvin </dd></dl>

</div>
</div>
<a id="af808958823310e3a795c479ac996fdcf" name="af808958823310e3a795c479ac996fdcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af808958823310e3a795c479ac996fdcf">&#9670;&nbsp;</a></span>Leaf_Temperatures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Leaf_Temperatures </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>slope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psychrometer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>VPD_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cp_ca</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gw_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gw_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gw_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gw_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gww_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gww_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gww_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gww_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gh_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gh_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gh_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gh_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Xcs_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Xcl_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Xcs_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Xcl_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radiation_o_sun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radiation_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radiation_u_sun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radiation_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Tc_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Tc_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Tc_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Tc_u_shaded</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate leaf temperature four components (sunlit and shaded leaves, overstory and understory) </p>
<p >[output] Tc_o_sunlit,Tc_o_shaded,Tc_u_sunlit,Tc_u_shaded </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Tair</td><td>air temperature </td></tr>
    <tr><td class="paramname">slope</td><td>the slope of saturation vapor pressure-temperature curve </td></tr>
    <tr><td class="paramname">psychrometer</td><td>psychrometer constant, 0.066 kPa K </td></tr>
    <tr><td class="paramname">VPD_air</td><td>vapor pressure deficit </td></tr>
    <tr><td class="paramname">Cp_ca</td><td>specific heat of moist air in kJ/kg/K </td></tr>
    <tr><td class="paramname">Gw_o_sunlit</td><td>total conductance for water from the intercellular space of the leaves to the reference height above the canopy, overstory, sunlit </td></tr>
    <tr><td class="paramname">Gw_o_shaded</td><td>..., overstory, shaded </td></tr>
    <tr><td class="paramname">Gw_u_sunlit</td><td>..., understory, sunlit </td></tr>
    <tr><td class="paramname">Gw_u_shaded</td><td>..., understory, shaded </td></tr>
    <tr><td class="paramname">Gww_o_sunlit</td><td>total conductance for water from the surface of the leaves to the reference height above the canopy, overstory, sunlit </td></tr>
    <tr><td class="paramname">Gww_o_shaded</td><td>..., overstory, shaded </td></tr>
    <tr><td class="paramname">Gww_u_sunlit</td><td>..., understory, sunlit </td></tr>
    <tr><td class="paramname">Gww_u_shaded</td><td>..., understory, shaded </td></tr>
    <tr><td class="paramname">Gh_o_sunlit</td><td>total conductance for heat transfer from the leaf surface to the reference height above the canopy, overstory, sunlit </td></tr>
    <tr><td class="paramname">Gh_o_shaded</td><td>..., overstory, shaded </td></tr>
    <tr><td class="paramname">Gh_u_sunlit</td><td>..., understory, sunlit </td></tr>
    <tr><td class="paramname">Gh_u_shaded</td><td>..., understory, shaded </td></tr>
    <tr><td class="paramname">Xcs_o</td><td>the fraction of canopy covered by snow, overstory </td></tr>
    <tr><td class="paramname">Xcl_o</td><td>the fraction of canopy covered by liquid water, overstory </td></tr>
    <tr><td class="paramname">Xcs_u</td><td>the fraction of canopy covered by snow, understory </td></tr>
    <tr><td class="paramname">Xcl_u</td><td>the fraction of canopy covered by liquid water, understory </td></tr>
    <tr><td class="paramname">radiation_o_sun</td><td>net radiation on leaves, overstory, sunlit </td></tr>
    <tr><td class="paramname">radiation_o_shaded</td><td>net radiation on leaves, overstory, shaded </td></tr>
    <tr><td class="paramname">radiation_u_sun</td><td>net radiation on leaves, understory, sunlit </td></tr>
    <tr><td class="paramname">radiation_u_shaded</td><td>net radiation on leaves, understory, shaded </td></tr>
    <tr><td class="paramname">Tc_o_sunlit</td><td>the effective canopy temperature in Kalvin, overstory, sunlit </td></tr>
    <tr><td class="paramname">Tc_o_shaded</td><td>the effective canopy temperature in Kalvin, overstory, shaded </td></tr>
    <tr><td class="paramname">Tc_u_sunlit</td><td>the effective canopy temperature in Kalvin, understory, sunlit </td></tr>
    <tr><td class="paramname">Tc_u_shaded</td><td>the effective canopy temperature in Kalvin, understory, shaded </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a74d0e9f235b59eaf094a63d6e697c8e3" name="a74d0e9f235b59eaf094a63d6e697c8e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74d0e9f235b59eaf094a63d6e697c8e3">&#9670;&nbsp;</a></span>meteo_pack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void meteo_pack </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>meteo_pack_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate meteorological variables based on input. </p>
<p >default input is temperature (C) and relative humidity (0-100) output is an array, named as meteo_pack_output []</p>
<p >[input] meteo_pack_output [1]= air_density kg/m3 <br  />
 meteo_pack_output [2]= specific heat of air J/kg/C <br  />
 meteo_pack_output [3]= VPD kPa <br  />
 meteo_pack_output [4]= slope of vapor pressure to temperature kPa/C <br  />
 meteo_pack_output [5]= psychrometer constant kPa/C <br  />
 meteo_pack_output [6]= saturate water vapor potential kPa <br  />
 meteo_pack_output [7]= actual water vapor potential kPa <br  />
 meteo_pack_output [8]= specific humidity g/g </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temp</td><td>temperature </td></tr>
    <tr><td class="paramname">rh</td><td>relative humidity </td></tr>
    <tr><td class="paramname">meteo_pack_output</td><td>meteorological variables array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="ad0512f7c2c7920479e2f293a8047363e" name="ad0512f7c2c7920479e2f293a8047363e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0512f7c2c7920479e2f293a8047363e">&#9670;&nbsp;</a></span>netRadiation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void netRadiation </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shortRad_global</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CosZs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_us</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>clumping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>albedo_snow_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>albedo_snow_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>percentArea_snow_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>percentArea_snow_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>percent_snow_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>albedo_v_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>albedo_n_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>albedo_v_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>albedo_n_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>albedo_v_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>albedo_n_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>netRad_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>netRad_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>netRad_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>netRadLeaf_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>netRadLeaf_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>netRadLeaf_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>netRadLeaf_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>netShortRadLeaf_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>netShortRadLeaf_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>netShortRadLeaf_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>netShortRadLeaf_u_shaded</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate net radiation at canopy level and leaf level. </p>
<p >[input] global solar radiation, cosine value for solar zenith angle, albedo of leaves albedo of snow, percentage of snow cover, leaf area index overstorey and understorey, temperature of overstorey, understorey and ground (contain snow?) temperature of air (C), relative humidity (0-100)</p>
<p >[output] net radiation for canopy, overstorey, understorey and ground; net radiation on sunlit, shaded leaves of overstorey and understorey. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shortRad_global</td><td>global short radiation </td></tr>
    <tr><td class="paramname">CosZs</td><td>cosine value of solar zenith angle </td></tr>
    <tr><td class="paramname">temp_o</td><td>temperature of overstorey </td></tr>
    <tr><td class="paramname">temp_u</td><td>temperature of understory </td></tr>
    <tr><td class="paramname">temp_g</td><td>temperature of ground </td></tr>
    <tr><td class="paramname">lai_o</td><td>leaf area index of overstory, without stem </td></tr>
    <tr><td class="paramname">lai_u</td><td>leaf area index of understory, without stem </td></tr>
    <tr><td class="paramname">lai_os</td><td>leaf area index of overstory, with stem </td></tr>
    <tr><td class="paramname">lai_us</td><td>leaf area index of understory, with stem </td></tr>
    <tr><td class="paramname">lai_o_sunlit</td><td>sunlit leaves LAI with consideration of stem, overstory </td></tr>
    <tr><td class="paramname">lai_o_shaded</td><td>shaded leaves LAI with consideration of stem, overstory </td></tr>
    <tr><td class="paramname">lai_u_sunlit</td><td>sunlit leaves LAI with consideration of stem, understory </td></tr>
    <tr><td class="paramname">lai_u_shaded</td><td>shaded leaves LAI with consideration of stem, understory </td></tr>
    <tr><td class="paramname">clumping</td><td>clumping index </td></tr>
    <tr><td class="paramname">temp_air</td><td>air temperature </td></tr>
    <tr><td class="paramname">rh</td><td>relative humidity </td></tr>
    <tr><td class="paramname">albedo_snow_v</td><td>albedo of snow in this step, visible </td></tr>
    <tr><td class="paramname">albedo_snow_n</td><td>albedo of snow in this step, near infrared </td></tr>
    <tr><td class="paramname">percentArea_snow_o</td><td>percentage of snow on overstorey (by area) </td></tr>
    <tr><td class="paramname">percentArea_snow_u</td><td>percentage of snow on understorey (by area) </td></tr>
    <tr><td class="paramname">percent_snow_g</td><td>percentage of snow on ground (by mass) </td></tr>
    <tr><td class="paramname">albedo_v_o</td><td>albedo of overstory, visible, not considering snow, decided by land cover </td></tr>
    <tr><td class="paramname">albedo_n_o</td><td>albedo of overstory, near infrared </td></tr>
    <tr><td class="paramname">albedo_v_u</td><td>albedo of understory, visible </td></tr>
    <tr><td class="paramname">albedo_n_u</td><td>albedo of understory, near infrared </td></tr>
    <tr><td class="paramname">albedo_v_g</td><td>albedo of ground, visible </td></tr>
    <tr><td class="paramname">albedo_n_g</td><td>albedo of ground, near infrared </td></tr>
    <tr><td class="paramname">netRad_o</td><td>net radiation on overstorey </td></tr>
    <tr><td class="paramname">netRad_u</td><td>net radiation on understorey </td></tr>
    <tr><td class="paramname">netRad_g</td><td>net radiation on ground </td></tr>
    <tr><td class="paramname">netRadLeaf_o_sunlit</td><td>net radiation at the leaf level, overstory sunlit, for ET calculation </td></tr>
    <tr><td class="paramname">netRadLeaf_o_shaded</td><td>net radiation at the leaf level, overstory shaded </td></tr>
    <tr><td class="paramname">netRadLeaf_u_sunlit</td><td>net radiation at the leaf level, understory sunlit </td></tr>
    <tr><td class="paramname">netRadLeaf_u_shaded</td><td>net radiation at the leaf level, understory shaded </td></tr>
    <tr><td class="paramname">netShortRadLeaf_o_sunlit</td><td>net shortwave radiation at leaf level, overstory sunlit, for GPP calculation </td></tr>
    <tr><td class="paramname">netShortRadLeaf_o_shaded</td><td>net shortwave radiation at leaf level, overstory shaded </td></tr>
    <tr><td class="paramname">netShortRadLeaf_u_sunlit</td><td>net shortwave radiation at leaf level, understory sunlit </td></tr>
    <tr><td class="paramname">netShortRadLeaf_u_shaded</td><td>net shortwave radiation at leaf level, understory shaded </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a63d88c03d1b3c21080b3873f6c88bc02" name="a63d88c03d1b3c21080b3873f6c88bc02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63d88c03d1b3c21080b3873f6c88bc02">&#9670;&nbsp;</a></span>photosynthesis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void photosynthesis </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_leaf_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rad_leaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>e_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>g_lb_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vc_opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f_soilwater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b_h2o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_h2o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_leaf_c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LH_leaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Gs_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>aphoto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ci</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate leaf photosynthesis by solving a cubic equation. </p>
<p >[output] stomatal conductance to water vapor (m s-1); net photosynthesis rate (umol CO2 m-2 s-1); intercellular co2 concentration (ppm) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temp_leaf_p</td><td>temporary variables, to be removed later </td></tr>
    <tr><td class="paramname">rad_leaf</td><td>net shortwave radiation (W/m2) </td></tr>
    <tr><td class="paramname">e_air</td><td>water vapor pressure above canopy (kPa) </td></tr>
    <tr><td class="paramname">g_lb_w</td><td>leaf laminar boundary layer conductance to H2O (m/s) </td></tr>
    <tr><td class="paramname">vc_opt</td><td>the maximum velocities of carboxylation of Rubisco at 25 deg C (umol m-2 s-1) </td></tr>
    <tr><td class="paramname">f_soilwater</td><td>an empirical scalar of soil water stress on stomatal conductance, dimensionless </td></tr>
    <tr><td class="paramname">b_h2o</td><td>the intercept term in BWB model (mol H2O m-2 s-1) </td></tr>
    <tr><td class="paramname">m_h2o</td><td>the slope in BWB model </td></tr>
    <tr><td class="paramname">cii</td><td>initial intercellular co2 concentration (ppm) </td></tr>
    <tr><td class="paramname">temp_leaf_c</td><td>leaf temperature (deg C) </td></tr>
    <tr><td class="paramname">LH_leaf</td><td>leaf latent heat flux (W m-2) </td></tr>
    <tr><td class="paramname">Gs_w</td><td>stomatal conductance to water vapor (m s-1) </td></tr>
    <tr><td class="paramname">aphoto</td><td>net photosynthesis rate (umol CO2 m-2 s-1) </td></tr>
    <tr><td class="paramname">ci</td><td>intercellular co2 concentration (ppm) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a5fc871429841fb77b43893474a5e0451" name="a5fc871429841fb77b43893474a5e0451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fc871429841fb77b43893474a5e0451">&#9670;&nbsp;</a></span>plantresp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plantresp </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structresults.html">results</a> *&#160;</td>
          <td class="paramname"><em>mid_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_yr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_soil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CosZs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate plant respiration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LC</td><td>land cover type </td></tr>
    <tr><td class="paramname">mid_res</td><td>results struct </td></tr>
    <tr><td class="paramname">lai_yr</td><td>annual mean leaf area index </td></tr>
    <tr><td class="paramname">lai</td><td>daily leaf area index </td></tr>
    <tr><td class="paramname">temp_air</td><td>air temperature </td></tr>
    <tr><td class="paramname">temp_soil</td><td>soil temperature </td></tr>
    <tr><td class="paramname">CosZs</td><td>cosine of solar zenith angle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a62a1eec9667a887e1a9bfd32a56ea67c" name="a62a1eec9667a887e1a9bfd32a56ea67c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62a1eec9667a887e1a9bfd32a56ea67c">&#9670;&nbsp;</a></span>rainfall_stage1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rainfall_stage1 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipitation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mass_water_o_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mass_water_u_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>clumping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_water_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_water_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>percent_water_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>percent_water_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>precipitation_g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function of rainfall stage1. </p>
<p >[rainfall_stage1] happens before evaporation of intercepted water from canopy (supply)</p>
<p >[input] air temperature, precipitation (m/s), remain of water on leaves from last step (kg/m2) per leaf area leaf area index of overstorey and understorey, excluding stem. length of this step (s), if time step is 10min, then it is set as 600, air temperature and humidity</p>
<p >[output] percentage of canopy covered by rainfall, overstorey and understorey (provided to evaporation_canopy), mass of water available for evaporation on canopy in this step precipitation on ground</p>
<p >[optical output] intercepted mass of rainfall in this step </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temp_air</td><td>air temperature (Celsius) </td></tr>
    <tr><td class="paramname">precipitation</td><td>precipitation rate (m/s) </td></tr>
    <tr><td class="paramname">mass_water_o_last</td><td>remains of water from last step, overstory </td></tr>
    <tr><td class="paramname">mass_water_u_last</td><td>remains of water from last step, understory </td></tr>
    <tr><td class="paramname">lai_o</td><td>leaf area index, overstory </td></tr>
    <tr><td class="paramname">lai_u</td><td>leaf area index, understory </td></tr>
    <tr><td class="paramname">clumping</td><td>clumping index </td></tr>
    <tr><td class="paramname">mass_water_o</td><td>mass of water on leaves (kg/m2) per ground area, overstory </td></tr>
    <tr><td class="paramname">mass_water_u</td><td>mass of water on leaves (kg/m2) per ground area, understory </td></tr>
    <tr><td class="paramname">percent_water_o</td><td>the fraction of canopy covered by liquid water and snow, overstory </td></tr>
    <tr><td class="paramname">percent_water_u</td><td>the fraction of canopy covered by liquid water and snow, understory </td></tr>
    <tr><td class="paramname">precipitation_g</td><td>precipitation on ground </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a5b417e26208501b9cbcc8576b136e598" name="a5b417e26208501b9cbcc8576b136e598"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b417e26208501b9cbcc8576b136e598">&#9670;&nbsp;</a></span>rainfall_stage2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rainfall_stage2 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo_water_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo_water_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_water_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_water_u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function of rainfall stage2. </p>
<p >[rainfall_stage2] happens after evaporation of intercepted water from canopy (demand)</p>
<p >[input] mass of water on leaves after precipitation in this step, evaporation from leaves in this step</p>
<p >[output] mass of water on leaves after the evaporation on leaves in this step (this value is transferred to next step) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">evapo_water_o</td><td>evaporation of intercepted rain in this step, overstorey, kg/m2/s = mm/s </td></tr>
    <tr><td class="paramname">evapo_water_u</td><td>evaporation of intercepted rain in this step, understorey, kg/m2/s = mm/s </td></tr>
    <tr><td class="paramname">mass_water_o</td><td>supply of rain on leaves, overstory, already added precipitation in this step </td></tr>
    <tr><td class="paramname">mass_water_u</td><td>supply of rain on leaves, understory, already added precipitation in this step </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="ac0fb52abdb8d4443b5f924713f66c6d1" name="ac0fb52abdb8d4443b5f924713f66c6d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0fb52abdb8d4443b5f924713f66c6d1">&#9670;&nbsp;</a></span>s_coszs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void s_coszs </td>
          <td>(</td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>jday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>CosZs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate cosine solar zenith angle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jday</td><td>date of year </td></tr>
    <tr><td class="paramname">j</td><td>local time/UTC time code needs to be edited according to time format </td></tr>
    <tr><td class="paramname">lat</td><td>latitude of site </td></tr>
    <tr><td class="paramname">lon</td><td>longitude of site </td></tr>
    <tr><td class="paramname">CosZs</td><td>cosine solar zenith angle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="afe6bee973e8941b047b6da31abd2fd40" name="afe6bee973e8941b047b6da31abd2fd40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe6bee973e8941b047b6da31abd2fd40">&#9670;&nbsp;</a></span>sensible_heat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sensible_heat </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rh_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gheat_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gheat_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gheat_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gheat_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gheat_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SH_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SH_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SH_g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate sensible heat. </p>
<p >[input] temperature of sunlit and shaded leaves from other storey (leaf temperature module); temperature of air; relative humidity; temperature of ground (soil heat flux module); aerodynamic heat conductance of sunlit shaded leaves from overstorey and understorey; aerodynamic heat conductance of ground; leaf area index, sunlit and shaded, overstorey and understorey (from leaf area index module);</p>
<p >[output] sensible heat from overstorey, understorey and ground </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tempL_o_sunlit</td><td>temperature of leaves, overstory, sunlit </td></tr>
    <tr><td class="paramname">tempL_o_shaded</td><td>temperature of leaves, overstory, shaded </td></tr>
    <tr><td class="paramname">tempL_u_sunlit</td><td>temperature of leaves, understory, sunlit </td></tr>
    <tr><td class="paramname">tempL_u_shaded</td><td>temperature of leaves, understory, shded </td></tr>
    <tr><td class="paramname">temp_g</td><td>temperature of ground </td></tr>
    <tr><td class="paramname">temp_air</td><td>air temperature </td></tr>
    <tr><td class="paramname">rh_air</td><td>relative humidity of air </td></tr>
    <tr><td class="paramname">Gheat_o_sunlit</td><td>aerodynamic resistance of heat, overstory, sunlit </td></tr>
    <tr><td class="paramname">Gheat_o_shaded</td><td>aerodynamic resistance of heat, overstory, shaded </td></tr>
    <tr><td class="paramname">Gheat_u_sunlit</td><td>aerodynamic resistance of heat, understory, sunlit </td></tr>
    <tr><td class="paramname">Gheat_u_shaded</td><td>aerodynamic resistance of heat, understory, shaded </td></tr>
    <tr><td class="paramname">Gheat_g</td><td>aerodynamic resistance of heat, ground </td></tr>
    <tr><td class="paramname">lai_o_sunlit</td><td>leaf area index, overstory, sunlit </td></tr>
    <tr><td class="paramname">lai_o_shaded</td><td>leaf area index, overstory, shaded </td></tr>
    <tr><td class="paramname">lai_u_sunlit</td><td>leaf area index, understory, sunlit </td></tr>
    <tr><td class="paramname">lai_u_shaded</td><td>leaf area index, understory, shaded </td></tr>
    <tr><td class="paramname">SH_o</td><td>sensible heat, overstory </td></tr>
    <tr><td class="paramname">SH_u</td><td>sensible heat, understory </td></tr>
    <tr><td class="paramname">SH_g</td><td>sensible heat, ground </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a7970c5267f32a503569127e3ba702edd" name="a7970c5267f32a503569127e3ba702edd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7970c5267f32a503569127e3ba702edd">&#9670;&nbsp;</a></span>snowpack_stage1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void snowpack_stage1 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipitation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mass_snow_o_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mass_snow_u_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mass_snow_g_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_snow_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_snow_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_snow_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>clumping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>area_snow_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>area_snow_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>percent_snow_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>percent_snow_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>percent_snow_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>density_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depth_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>albedo_v_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>albedo_n_snow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function of snowpack stage1. </p>
<p >[snowpack_stage1] happens before any consumption of snow in this step, after the snow fall (supply)</p>
<p >[Input] air temperature, precipitation,depth of snow from last step, density of snow from last step, mass of snow on canopy and ground (per ground area) from last step, length of step, leaf area index of overstorey and understorey excluding stem, albedo of snow from last step.</p>
<p >[Output] mass of snow on canopy and ground accumulation of snowfall, albedo of snow in this step, density of snow in this step. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temp_air</td><td>air temperature </td></tr>
    <tr><td class="paramname">precipitation</td><td>precipitation (m/s) </td></tr>
    <tr><td class="paramname">mass_snow_o_last</td><td>weight of snow at overstorey from last step </td></tr>
    <tr><td class="paramname">mass_snow_u_last</td><td>weight of snow at understorey from last step </td></tr>
    <tr><td class="paramname">mass_snow_g_last</td><td>weight of snow on ground from last step </td></tr>
    <tr><td class="paramname">mass_snow_o</td><td>mass of intercepted snow at overstory, input from last step, kg/m2 </td></tr>
    <tr><td class="paramname">mass_snow_u</td><td>mass of intercepted snow at understory, input from last step, kg/m2 </td></tr>
    <tr><td class="paramname">mass_snow_g</td><td>mass of intercepted snow on ground, input from last step, kg/m2 </td></tr>
    <tr><td class="paramname">lai_o</td><td>overstory lai </td></tr>
    <tr><td class="paramname">lai_u</td><td>understory lai </td></tr>
    <tr><td class="paramname">clumping</td><td>clumping index </td></tr>
    <tr><td class="paramname">area_snow_o</td><td>area of snow at overstorey </td></tr>
    <tr><td class="paramname">area_snow_u</td><td>area of snow at understorey </td></tr>
    <tr><td class="paramname">percent_snow_o</td><td>percentage of snow cover at overstory, DECIDED by weight </td></tr>
    <tr><td class="paramname">percent_snow_u</td><td>percentage of snow cover at understory, DECIDED by weight </td></tr>
    <tr><td class="paramname">percent_snow_g</td><td>percentage of snow cover on ground, DECIDED by weight </td></tr>
    <tr><td class="paramname">density_snow</td><td>density of snowpack on ground, input from last step, then changed in this module </td></tr>
    <tr><td class="paramname">depth_snow</td><td>depth of snowpack, input from last step, changed here, then changed in stage2 </td></tr>
    <tr><td class="paramname">albedo_v_snow</td><td>visible albedo of snow, input from this step, changed in this module </td></tr>
    <tr><td class="paramname">albedo_n_snow</td><td>near infrared albedo of snow, input from this step, changed in this module </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a6d6185a683cfa4bcc98870f6108666bc" name="a6d6185a683cfa4bcc98870f6108666bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d6185a683cfa4bcc98870f6108666bc">&#9670;&nbsp;</a></span>snowpack_stage2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void snowpack_stage2 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo_snow_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo_snow_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_snow_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_snow_u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function of snowpack stage2. This module will calculate the snow remained on canopy surface after evaporation in this step. </p>
<p >[snowpack_stage2] happens after sublimation from ground and canopy (demand)</p>
<p >[input] mass of snow on leaves after precipitation in this step, sublimation from leaves in this step</p>
<p >[output] mass of snow on leaves after the sublimation on leaves in this step </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">evapo_snow_o</td><td>evaporation of intercepted rain in this step, overstorey, kg/m2/s = mm/s </td></tr>
    <tr><td class="paramname">evapo_snow_u</td><td>evaporation of intercepted rain in this step, understorey, kg/m2/s = mm/s </td></tr>
    <tr><td class="paramname">mass_snow_o</td><td>supply of rain on leaves, overstorey, already added precipitation in this step </td></tr>
    <tr><td class="paramname">mass_snow_u</td><td>supply of rain on leaves, understorey, already added precipitation in this step </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a21f2bf33a62ab7d7acba0decde33b961" name="a21f2bf33a62ab7d7acba0decde33b961"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21f2bf33a62ab7d7acba0decde33b961">&#9670;&nbsp;</a></span>snowpack_stage3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void snowpack_stage3 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_snow_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>density_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depth_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depth_water</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mass_snow_g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function of snowpack stage3. This module simulates the process of snow melting and water frozen in this step. </p>
<p >[snowpack stage3] happens after frozen and melt of snow pack (demand)</p>
<p >[input] depth of snow on ground after stage 1, air temperature, ground surface temperature</p>
<p >[output] the amount of the melted snow, frozen snow </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temp_air</td><td>temperature of air in this step </td></tr>
    <tr><td class="paramname">temp_snow</td><td>temperature of snow in this step </td></tr>
    <tr><td class="paramname">temp_snow_last</td><td>temperature of snow in last step </td></tr>
    <tr><td class="paramname">density_snow</td><td>density of snow output from stage1 </td></tr>
    <tr><td class="paramname">depth_snow</td><td>depth of snow on ground after stage1 </td></tr>
    <tr><td class="paramname">mass_snow_g</td><td>mass of snow on ground after stage1 </td></tr>
    <tr><td class="paramname">depth_water</td><td>depth of water after all precipitation and evaporation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a7385d5d0240cacc36b46e53f792656ed" name="a7385d5d0240cacc36b46e53f792656ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7385d5d0240cacc36b46e53f792656ed">&#9670;&nbsp;</a></span>soilresp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void soilresp </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Ccd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Cssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Csmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Cfsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Cfmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Csm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>npp_yr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soiltype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_soil.html">Soil</a> *&#160;</td>
          <td class="paramname"><em>soilp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structresults.html">results</a> *&#160;</td>
          <td class="paramname"><em>mid_res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate soil respiration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ccd</td><td>carbon pool variable </td></tr>
    <tr><td class="paramname">Cssd</td><td>... </td></tr>
    <tr><td class="paramname">Csmd</td><td>... </td></tr>
    <tr><td class="paramname">Cfsd</td><td>... </td></tr>
    <tr><td class="paramname">Cfmd</td><td>... </td></tr>
    <tr><td class="paramname">Csm</td><td>... </td></tr>
    <tr><td class="paramname">Cm</td><td>... </td></tr>
    <tr><td class="paramname">Cs</td><td>... </td></tr>
    <tr><td class="paramname">Cp</td><td>... </td></tr>
    <tr><td class="paramname">npp_yr</td><td>a fraction of NPP transferred to biomass carbon pools </td></tr>
    <tr><td class="paramname">coef</td><td>soil coefficients array </td></tr>
    <tr><td class="paramname">soiltype</td><td>soil type </td></tr>
    <tr><td class="paramname">soilp</td><td>soil variables struct </td></tr>
    <tr><td class="paramname">mid_res</td><td>results struct </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<p >NEP <br  />
</p>

</div>
</div>
<a id="a543a621a86a39d5edf09723ff7252571" name="a543a621a86a39d5edf09723ff7252571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a543a621a86a39d5edf09723ff7252571">&#9670;&nbsp;</a></span>surface_temperature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void surface_temperature </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rh_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>depth_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>depth_water</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>capacity_heat_soil1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>capacity_heat_soil0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gheat_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>depth_soil1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>density_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>netRad_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo_soil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo_water_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo_snow_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lambda_soil1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>percent_snow_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heat_flux_soil1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_ground_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_soil1_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_any0_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_snow_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_soil0_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_snow1_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_snow2_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_ground</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_any0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_soil0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_snow1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>temp_snow2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>heat_flux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to simulate surface temperature, and heat flux from surface to soil layers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">temp_air</td><td>air temperature (Celsius degree) </td></tr>
    <tr><td class="paramname">rh_air</td><td>relative humidity (0-100) </td></tr>
    <tr><td class="paramname">depth_snow</td><td>depth of snow (m) </td></tr>
    <tr><td class="paramname">depth_water</td><td>depth of water on ground (m) </td></tr>
    <tr><td class="paramname">capacity_heat_soil1</td><td>heat capacity of layer1 soil (J/m2/K) </td></tr>
    <tr><td class="paramname">capacity_heat_soil0</td><td>heat capacity of layer2 soil (J/m2/K) </td></tr>
    <tr><td class="paramname">Gheat_g</td><td>aerodynamic conductance of heat on ground (m/s) </td></tr>
    <tr><td class="paramname">depth_soil1</td><td>depth of soil in layer1 (m) </td></tr>
    <tr><td class="paramname">density_snow</td><td>density of snow (kg/m3) </td></tr>
    <tr><td class="paramname">tempL_u</td><td>leaf temperature, understory (Celsius degree) </td></tr>
    <tr><td class="paramname">netRad_g</td><td>net radiation on ground (W/m2) </td></tr>
    <tr><td class="paramname">evapo_soil</td><td>evaporation from soil surface (mm/s) </td></tr>
    <tr><td class="paramname">evapo_water_g</td><td>evaporation from pond water on ground (mm/s) </td></tr>
    <tr><td class="paramname">evapo_snow_g</td><td>evaporation from snow pack on ground (mm/s) </td></tr>
    <tr><td class="paramname">lambda_soil1</td><td>thermal conductivity of layer1 soil (W/m/K) </td></tr>
    <tr><td class="paramname">percent_snow_g</td><td>percentage of snow coverage on ground (0-1) </td></tr>
    <tr><td class="paramname">heat_flux_soil1</td><td>heat flux from layer1 soil to the next soil layer (W/m2) </td></tr>
    <tr><td class="paramname">temp_ground_last</td><td>temperature of ground, from last step </td></tr>
    <tr><td class="paramname">temp_soil1_last</td><td>temperature of layer1 soil, from last step </td></tr>
    <tr><td class="paramname">temp_any0_last</td><td>temperature of any layer right above the soil, from last step </td></tr>
    <tr><td class="paramname">temp_snow_last</td><td>temperature of snow, from last step </td></tr>
    <tr><td class="paramname">temp_soil0_last</td><td>temperature of soil0, from last step </td></tr>
    <tr><td class="paramname">temp_snow1_last</td><td>temperature of snow layer 2, from last step </td></tr>
    <tr><td class="paramname">temp_snow2_last</td><td>temperature of snow layer 3, from last step </td></tr>
    <tr><td class="paramname">temp_ground</td><td>ground temperature at this step </td></tr>
    <tr><td class="paramname">temp_any0</td><td>temperature of any layer right above the soil could be a mixture of snow temperature and soil surface temperature </td></tr>
    <tr><td class="paramname">temp_snow</td><td>snow temperature at this step </td></tr>
    <tr><td class="paramname">temp_soil0</td><td>temperature of soil surface right above the soil, the part not covered by snow </td></tr>
    <tr><td class="paramname">temp_snow1</td><td>temperature of snow layer 2, used in depth_snow&gt;0.05 m </td></tr>
    <tr><td class="paramname">temp_snow2</td><td>temperature of snow layer 3, used in depth_snow&gt;0.05 m </td></tr>
    <tr><td class="paramname">heat_flux</td><td>heat flux from ground to soil </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a8fb46fbf5ca3c002533cbc36bf8dbe3a" name="a8fb46fbf5ca3c002533cbc36bf8dbe3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fb46fbf5ca3c002533cbc36bf8dbe3a">&#9670;&nbsp;</a></span>transpiration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transpiration </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tempL_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rh_air</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gtrans_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gtrans_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gtrans_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Gtrans_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_u_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>trans_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>trans_u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate transpiration. </p>
<p >A transformation of Penman-Monteith equation is used here. It could be regarded as a mass transfer process. Water vapor inside cells are required by VPD from air and VPD on leaf surface.</p>
<p >[input] temperature of sunlit and shaded leaves from other storey (leaf temperature module); temperature of air; relative humidity; conductance of water for sunlit shaded leaves from overstorey and understorey; leaf area index, sunlit and shaded, overstorey and understorey (from leaf area index module);</p>
<p >[output] transpiration from overstorey and understorey </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tempL_o_sunlit</td><td>temperature of leaf, overstory, sunlit </td></tr>
    <tr><td class="paramname">tempL_o_shaded</td><td>temperature of leaf, overstory, shaded </td></tr>
    <tr><td class="paramname">tempL_u_sunlit</td><td>temperature of leaf, understory, sunlit </td></tr>
    <tr><td class="paramname">tempL_u_shaded</td><td>temperature of leaf, understory, shaded </td></tr>
    <tr><td class="paramname">temp_air</td><td>air temperature </td></tr>
    <tr><td class="paramname">rh_air</td><td>relative humidity of air </td></tr>
    <tr><td class="paramname">Gtrans_o_sunlit</td><td>total conductance of water tandem of stomatal conductance and aerodynamic conductance, overstory, sunlit </td></tr>
    <tr><td class="paramname">Gtrans_o_shaded</td><td>..., overstory, shaded </td></tr>
    <tr><td class="paramname">Gtrans_u_sunlit</td><td>..., understory, sunlit </td></tr>
    <tr><td class="paramname">Gtrans_u_shaded</td><td>..., understory, shaded </td></tr>
    <tr><td class="paramname">lai_o_sunlit</td><td>leaf area index, overstory, sunlit </td></tr>
    <tr><td class="paramname">lai_o_shaded</td><td>leaf area index, overstory, shaded </td></tr>
    <tr><td class="paramname">lai_u_sunlit</td><td>leaf area index, understory, sunlit </td></tr>
    <tr><td class="paramname">lai_u_shaded</td><td>leaf area index, understory, shaded </td></tr>
    <tr><td class="paramname">trans_o</td><td>transpiration from overstory </td></tr>
    <tr><td class="paramname">trans_u</td><td>transpiration from understory </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a5fbeeca1b348f3732bdb2620e0be8937" name="a5fbeeca1b348f3732bdb2620e0be8937"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fbeeca1b348f3732bdb2620e0be8937">&#9670;&nbsp;</a></span>Vcmax_Jmax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Vcmax_Jmax </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lai_o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>clumping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vcmax0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>slope_Vcmax_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leaf_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CosZs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Vcmax_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Vcmax_shaded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Jmax_sunlit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Jmax_shaded</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to calculate the Vcmax and Jmax for sunlit and shaded leaf. </p>
<dl class="section note"><dt>Note</dt><dd>Vcmax0 is for the leaf vcmax at top of the canopy. LHE </dd>
<dd>
Just to clarify, in this version, Vcmax0 is still the average leaf Vcmax25, Vcmax0 * slope_Vcmax_N * leaf_N is the top leaves Vcmax25. XL. 20190403. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lai_o</td><td>overstory lai </td></tr>
    <tr><td class="paramname">clumping</td><td>clumping index </td></tr>
    <tr><td class="paramname">Vcmax0</td><td>maximum capacity of Rubisco at 25C-Vcmax </td></tr>
    <tr><td class="paramname">slope_Vcmax_N</td><td>slope of Vcmax-N curve </td></tr>
    <tr><td class="paramname">leaf_N</td><td>leaf Nitrogen content mean value + 1 SD g/m2 </td></tr>
    <tr><td class="paramname">CosZs</td><td>cosine solar zenith angle </td></tr>
    <tr><td class="paramname">Vcmax_sunlit</td><td>Vcmax of sunlit leaf </td></tr>
    <tr><td class="paramname">Vcmax_shaded</td><td>Vcmax of shaded leaf </td></tr>
    <tr><td class="paramname">Jmax_sunlit</td><td>Jmax of sunlit leaf </td></tr>
    <tr><td class="paramname">Jmax_shaded</td><td>Jmax of shaded leaf </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
